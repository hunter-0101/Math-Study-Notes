> [!info] Historical notes
> Joseph Fourier, in early 19th century, developed the idea of representing functions as sums of sines and cosines, motivated by the separation of variable method when solving the heat equation $u_t=\alpha u_{xx}$ ([[First Order PDE]]). As for Fourier transform, it came later in the need to handle non-periodic functions.

> [!info] Application of Fourier series
> Since Fourier series provide a uniform approximation of functions that behaves well enough, it's one of many sets of **base functions** (see [[Functional Approximation]] for more examples) that can be used to establish property of complicated functions by the standard mechanism. 
> **Pros**: the construction is explicit, and allows for many further analytic tools, like differentiation, integration, etc.
> **Cons**: only applicable to function on finite interval. [[FT on L1]] provide a partial solution for this problem.

--- 
Given $f:[0,L]\to\mathbb R$ we define its Fourier series as $$f(x)\sim\frac{1}{2}a_0+\sum_{n=1}^\infty a_n\cos\frac{2\pi nx}{L}+\sum_{n=1}^\infty b_n\sin\frac{2\pi nx}{L}$$Where the coefficients are given by $$\begin{align}a_n=a_n(f)&=\frac{2}{L}\int_0^L f(x)\cos\frac{2\pi nx}{L} dx,\quad n=0, 1,\dots\\b_n=b_n(f)&=\frac{2}{L}\int_0^L f(x)\sin\frac{2\pi nx}{L}dx,\quad n=1, 2,\dots\end{align}$$This is a special case of [[Hilbert Space]] with $\set{\sin\frac{2\pi n}{L}x,\cos\frac{2\pi n}{L}x:n\in\mathbb N}$ being a complete system of orthogonal basis under the inner product $\braket{f,g}=\int_0^Lfgdx$, which will be discussed below. 
- **Exponential form of Fourier series**: sometimes we choose another orthogonal system $\set{e^{2\pi inx/L}},n\in\mathbb Z$ with pairwise inner product $L\delta_{mn}$. We rewrite the expression as $$f(x)\sim\sum_{n=-\infty}^{+\infty}\hat f(n)e^{2\pi inx/L},\quad\hat f(n)=\frac{1}{L}\int_a^bf(x)e^{-2\pi inx/L}dx$$which is more often used in practice.
	- **Coefficients**: by Euler's formula ([[Complex Function]]) we have $$a_n=\hat f(n)+\hat f(-n),\quad b_n=i(\hat f(n)-\hat f(-n)),\quad n\in\mathbb N$$we know that if $f$ is real-valued then $\hat f(n)=\overline{\hat f(-n)}$, and further we have $\hat f(n)=\hat f(-n)$ for even function and $\hat f(n)=-\hat f(-n)$ for odd function.
## Convergence analysis
Below we use partial sum to investigate the convergence issue of Fourier series.
- **Partial sum**: for the partial sum $S_N=a_0/2+\sum_{n=1}^N(a_n\cos 2\pi nx+b_n\sin2\pi nx)$, choose $L=1$ for convenience, and by putting the above formula into it and with some calculation, we get$$\begin{align}S_N&=\int_0^1 f(t)dt+2\sum_{n=1}^N\left[\left(\int_0^1 f(t)\cos(2\pi nt)dt\right)\cos (2\pi nx)+\left(\int_0^1 f(t)\sin(2\pi nt)dt\right)\sin (2\pi nx)\right]\\&=\int_0^1 f(t)\left[1+2\sum_{n=1}^N(\cos (2\pi nt)\cos (2\pi nx)+\sin (2\pi nt)\sin (2\pi nx))\right]dt\\&=\int_0^1 f(t)\left[1+2\sum_{n=1}^N\cos (2\pi n(t-x))\right]dt\end{align}$$Similar expression can be obtained using exponential form. If we define the **Dirichlet kernel** $$D_N(t)=\sum_{n=-N}^Ne^{2\pi int}=1+2\sum_{n=1}^N\cos(2\pi nt)=\frac{\sin(2\pi(N+\frac{1}{2})t)}{\sin(\pi t)}$$then using notation of [[Convolution]] we get $$S_N(f)=f*D_N$$Most of the time we'll use the partial sum $S_N(f)$ to discuss convergence of Fourier series.
- **Cesàro sum**: define the **Fejér kernel** as $$F_N=\frac{1}{N}\sum_{n=0}^{N-1}D_n(t)=\frac{1}{N}\left(\frac{\sin(\pi Nt)}{\sin(\pi t)}\right)^2=\frac{1}{N}\left(\frac{1-\cos(2\pi Nt)}{1-\cos(2\pi i)}\right)$$Apply this kernel to the original function yields the Cesàro summation of partial sums $$\sigma_N(f)=f*F_N=\frac{1}{N}\sum_{n=0}^{N-1}S_N(f)$$We can verify that $\set{F_N}$ is a family of [[Convolution#Summability kernel]].
	- **Cesàro summation**: this is a technique to improve the convergence of a series. Given $\set{a_n}$ define $A_n=\frac{1}{n}\sum_{i=1}^na_n$, then $\lim A_n$ might exist even if $\lim a_n$ does not. [[Series]]
- **Fejér theorem**: if $f$ is piecewise continuous on $\mathbb T$ and continuous at the point $t$, then $$\lim_{N\to\infty}\sigma_N(t)=f(t)$$this is a direct result of summability kernels. [[Convolution]]
	- **Convergence**: as long as $\|\hat f\|_{\ell^1(\mathbb Z)}<\infty$, the Fourier series would converge to $f(t)$ for all $t\in\mathbb T$, and the convergence is **uniform** and **absolute** (since$|e^{ix}|=1$ is bounded).
	- **Uniqueness**: from the above corollary we further know that if $f$ is piecewise continuous and $\hat f(n)=0,\forall n\in\mathbb Z$, then $f=0$ at all points where it's continuous.
- **De La Vallée Poussin sum**: denote $\sigma_{n,m}=\frac{1}{m-n}(m\sigma_m-n\sigma_n)$ then $\sigma_{n,m}$ inherits the same limit as Fejér kernel. Notice that given $|\hat f(n)|\le A|n|^{-1}$, we have $$|\sigma_{kn,(k+1)n}(f)(t)-S_m(f)(t)|\le2 Ak^{-1}$$for all $kn\le m<k(n+1)$, hence we have a finer convergence criterion: for $f:\mathbb T\to\mathbb C$ Riemann integrable with $\hat f(n)=O(|n|^{-1})$ as $n\to\infty$, $S_n(f)\to f$ for all continuous point, and the convergence is uniform when $f\in C(\mathbb T)$. 
	- **Intuition**: Cesàro summation ensures the right limit, but in above theorem we only use Weierstrass M-test to ensure convergence, which is quite weak. The key idea behind the Poussin sum is to check when $S_n$ is Cauchy, which requires weaker condition compared to M-test.
- **Pointwise convergence**: for $f:\mathbb T\to\mathbb R$, if it has one-sides limits as well as one-sided derivatives at $t$, then its Fourier series converges to $\frac{1}{2}(f(t^+)+f(t^-))$. The approximation to the identity property is enough to establish the result.
	- **Carleson's theorem**: if $f\in C(\mathbb T)$, then its Fourier series converges at all points except possibly for a null set.
	- **Kahane & Katznelson**: if $E$ is a null set on $\mathbb T$, then there exists a continuous function such that its Fourier series diverges precisely for all $t\in E$.
- **Riemann-Lebesgue lemma**: if $\psi$ is integrable or absolutely integrable on $[a,b]$, then $$\lim_{p\to\infty}\int_a^b\psi(x)\sin pxdx=\lim_{p\to\infty}\int_a^b\psi(x)\cos pxdx=\int_a^b\lim_{p\to\infty}\psi(x)e^{ipx}dx=0$$**Proof**: the proof follows the [[Standard Mechanism]]: first assume that the function is constant, then consider the piecewise constant ones, and finally approximate the function with step function ensured by Riemann integrability. 
	- **Corollary**: convergence of Fourier series for integrable or absolutely integrable functions $f$ at $x$ depends only on its behavior on $(x-\delta,x+\delta)$ where $\delta$ can be arbitrarily small.
- **Rate of convergence**: convergence of FS can be arbitrarily slow. Formally, given any $\set{\delta_n}\to0$, there exists continuous $f:\mathbb T\to\mathbb C$ with $S_n(f)\to f$ uniformly, but $\sup|f(t)-S_n(f)(t)|\ge\delta_n,\forall n$.
  **Proof**: let $a_n=0,\forall n\le-1;a_0=0;a_n=\delta_n-\delta_{n-1},\forall n\ge1$, then $\sum_{-N}^N|a_n|$ converges, hence the corresponding $S_n(f)$ converges uniformly, but $S_n(f)(0)-f(0)=-\sum_{k=n+1}^\infty a_n=\delta_n$.
- **Du Bois-Reymond function**: there exists a continuous $f:\mathbb T\to\mathbb C$ with $\limsup_n|S_n(f)(0)|=\infty$.
  **Proof**: we construct the function by first find some "bad enough" functions whose $S_n$ is large, and then pile them up to get a "really bad" function.
  1. $S_n(f)(0)=\int_\mathbb T f(x)D_n(-x)$. Notice that $\int|D_n(x)|=O(\ln n)$, pick $f_n(x)=\operatorname{sgn}D_n(-x)$, then $S_n(f_n)(0)\to\infty$ as $n\to\infty$.
  2. Since both $|\hat g-\hat h|$ and $|S_n(g)-S_n(h)|$ can be bounded by $\int_\mathbb T|g-h|$, for each $f_n$ we can construct a continuous $g_n$ that is close enough under $L^1(\mathbb T)$ norm, s.t. $S_n(g_n)(0)=O(\ln n)$.
  3. By uniform density of trigonometric polynomial ([[Functional Approximation]]) $g_n$ above can be replaced by a trigonometric polynomial $G_n$ that is bounded by a constant (independent of $n$) with $S_n(G_n)(0)=O(\ln n)$.
  4. By 3 we can construct a sequence of trigonometric polynomials $H_k$ with integer $n(k)$ s.t. $$|H_k(s)|\le1,|S_{n(k)}(H_k)(0)|\ge2^{2k},\quad\forall k\in\mathbb N$$Write $H_k=\sum_{r=-q(k)}^{q(k)}a_k\exp(irt)$, choosing $q(k)$ s.t. $q(k)\ge q(k-1),q(k)>n(k)$, and let $p(k)=\sum_{j=1}^k(2q(j)+1)$. Let $f_m(t)=\sum_{k=1}^m2^{-k}\exp(ip(k)t)H_k(t)$, then it can e verified that $f_m$ converges uniformly to some continuous $f$.
  5. Notice that $\hat f_m(p(k)+u)=2^{-k}\hat H_k(u)$ for $m\ge k,|u|\le q(k)$, similarly $\hat f(r)=0,r<0$. Hence $$\begin{align}|S_{p(k)+n(k)}(f)(0)-S_{p(k)-n(k)}(f)(0)|&=\left|\sum_{u=-n(k)}^{n(k)}2^{-k}\hat H_k(u)\exp(i(p(k)+u)t)\right|\\&=\left|\sum_{u=-n(k)}^{n(k)}2^{-k}\hat H(u)\exp(iut)\right|\\&=2^{-k}|S_{n(k)}(H_k)(0)|\ge 2^k\end{align}$$thus $\lim_{k\to\infty}\max(|S_{p(k)+n(k)}(f)(0)|,|S_{p(k)-n(k)}(f)(0)|)=\infty$.
## Gibbs phenomenon
Computation show that there is always a roughly $9\%$ **overshooting** at discontinuities in Fourier series w.r.t jumping size. Formally speaking, for $f:\mathbb R\to\mathbb R$ piecewise continuous with period $L$ and discontinuity at $x_0$, we have $$f(x_0^+)-f(x_0^-)=c\neq0\quad\Longrightarrow\quad\begin{align}& \lim_{N\to\infty}S_Nf(x_0+\frac{L}{2N})=f(x_0^+)+c\cdot\epsilon\\&\lim_{N\to\infty}S_Nf(x_0-\frac{L}{2N})=f(x_0^-)-c\cdot\epsilon\end{align}$$where $\epsilon=\frac{1}{\pi}\int_0^\pi\frac{\sin t}{t}dt-\frac{1}{2}\approx0.08949$.
**Proof**: we may express as $f=f_c+f_s$ the sum of continuous part and multi-step part. Thus it suffices to proof the case of unit step function. The rest is some straightforward but tedious calculation, including using differentiation to find maxima and transform infinite summation into integral.
- **Corollary**: following the above decomposition we know that the Fourier series would converge to the midpoint of the limits of both sides.
## Properties of Fourier series
- **Term-wise integration**: for $f\in L^1(\mathbb T)$ we have $$\int_\mathbb Tf(x)dx=\sum_{n\in\mathbb Z}\int_\mathbb T\hat f(n)e^{2\pi inx}dx=\int_\mathbb T\frac{a_0}{2}dx+\sum_{n=1}^\infty\int_\mathbb T(a_n\cos(2\pi nx)+b_n\sin(2\pi nx))dx$$This is guaranteed by DCT in [[Lebesgue Integral]], since $|e^{ix}|=1$.
- **Term-wise differentiation**: if $f\in C^1(\mathbb T)$ then by integration by parts we have $$f'(x)=2\pi i\sum_{n\in\mathbb Z}n\hat f(n)e^{2\pi inx}=2\pi\sum_{n=1}^\infty(-a_nn\sin(2\pi nx)+b_nn\cos(2\pi nx))$$For $f\in C^k(\mathbb T)$ the differentiation can be repeated $k$ times. Conversely if $\sum_{n\in\mathbb Z}|n|^k|\hat f(n)|<\infty$, then $f\in C^k$. This is due to the more general result that uniform convergence of $\set{f'}$ implies differentiability of $f$. [[Function on Euclidean Space]]
	- **Corollary**: since Fourier coefficient is bounded (say, by the integration of the original function on $\mathbb T$), repeating the above theorem yields that for $f\in C^k(\mathbb T)$ there is a constant $M=M(k)$ such that $$|\hat f(n)|\le M/|n^k|,\quad\forall n$$Actually by Riemann-Lebesgue lemma a stronger (but also somehow weaker) result is that $\lim_{n\to\infty}n^k\hat f(n)=0$.
- **Basis property**: denote $T_n$ the trigonometric polynomials of order $n$, then $S_n$ is the least square approximation of $f$. Moreover, $\set{e^{2\pi inx}}_{n\in\mathbb Z}$ is a complete system in $L^2(\mathbb T)$.
  **Proof**: 
  1. by Riemann integrability $f\in L^2$ can be approximated uniformly by a step function $g$ with $\|f-g\|<\varepsilon$. 
  2. We "round off the corner" for $g$ to obtain $h$ such that $h\in C^2,\|g-h\|<\varepsilon$ (this is always possible via, say, integral smoothing). 
  3. Now since $\hat h(n)<M/n^2$ for some constant $M$, the approximation $S_N(h)\to h$ is also uniform, thus $\|h-S_N(h)\|<\varepsilon$. Combining three inequalities yields $\|f-S_N(h)\|<3\varepsilon$, completing the proof.
- **Bessel's inequality**: we have $$\frac{a_0^2}{2}+\sum_{i=1}^n(a_i^2+b_i^2)\le\int_\mathbb T f^2(x)dx$$This is a direct result of the inner product space theory on $L^2$, and it shows that squares of Fourier coefficients actually form a convergent series. [[Hilbert Space]]
	- **Parseval's identity**: Bessel's inequality is an identity, i.e., under Fourier basis we have $$\|f\|_{L^2}^2=\int_\mathbb T|f(x)|^2dx=\sum_{n\in\mathbb Z}|\hat f(n)|^2$$A more general form of this is the **polarized Parseval relation** $$\int_\mathbb Tf(x)\overline{g(x)}dx=\sum_{n\in\mathbb Z}\hat f(n)\overline{\hat g(n)}$$Its continuous version and corresponding proof is in [[FT on L1]]. Related discussion in the background of inner product space can be found in [[Hilbert Space]].
## Multidimensional Fourier series
For $f:\mathbb T^d\to\mathbb C$ we still consider two classes of functions.
- $f\in L^1(\mathbb T^d)$: the condition is in the sense that $\int_{\mathbb T^d}|f(\mathbf x)|d\mathbf x<\infty$.
- $f\in L^2(\mathbb T^d)$: the inner product is defined similarly, and the basis becomes $$\varphi_{\mathbf n}(\mathbf x)=e^{i\mathbf n\cdot\mathbf x}=\exp(i(n_1x_1+\cdots+n_dx_d)),\quad\langle\varphi_{\mathbf m},\varphi_{\mathbf n}\rangle=(2\pi)^d\delta_{\mathbf m\mathbf n}$$here $\delta$ is the multidimensional Kronecker delta.
Overall, the inversion formula takes the form $$f(x)\sim\sum_{\mathbf n\in\mathbb Z^d}c_\mathbf ne^{i\mathbf n\cdot\mathbf x},\quad c_{\mathbf n}=\frac{1}{(2\pi)^d}\int_{\mathbb T^d}f(\mathbf x)e^{-i\mathbf n\cdot\mathbf x}$$and all analysis above still applies.