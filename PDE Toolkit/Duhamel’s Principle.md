**Duhamel's principle** is a general method for obtaining solutions to **inhomogeneous linear PDE**(in particular, evolution equation) from its homogeneous solution. Formally, consider a linear inhomogeneous equation for $u:D\times(0,\infty)\to\mathbb R,D\subset\mathbb R^n$ by $$\begin{cases}u_t-Lu=f,&(x,t)\in D\times(0,\infty)\\u|_{\partial D}=0,\\u(x,0)=0,&x\in D\end{cases}$$where $L$ is a linear operator ([[Linear PDE]]) that **involves no time derivatives**. Duhamel's principle is, formally, that the solution to this problem is $$u(x,t)=\int_0^tu^s(x,t)ds$$where $u^s$ is the solution of the problem $$\begin{cases}u_t^s-Lu^s=0,&(x,t)\in D\times(s,\infty)\\u^s|_{\partial D}(x,s)=0,\\u^s(x,s)=f(x,s),&x\in D\end{cases}$$This can be proved by a straightforward substitution. 
- **Intuition**: consider a [[Linear ODE System]] $$\frac{d}{dx}X=AX\where A\in M_n(\mathbb R)$$Assume that $R_t$ is the solution operator, i.e., $X(t)=R_tX(0)$ is the solution to the above system with initial value $X(0)$, then by [[Differentiation Under the Integral Sign]] we get $$X(t)=\int_0^tR_{t-s}Y(s)ds\imply\left(\pard{}{t}-A\right)X(t)=\int_0^t\left(\pard{}{t}-A\right)(R_{t-s}Y(s))ds+R_{t-s}Y(s)|_{s=t}$$Notice that the integrand vanishes by definition of $R_t$, hence we get $$\left(\pard{}{t}-A\right)X(t)=R_0Y(t)=Y(t)$$That is, $X(t)$ solves the inhomogeneous problem. This is exactly what's happening in the deduction of Duhamel's principle, except that differentiation under the integral sign is now applied on partial derivatives and multiple integral. 
## General Duhamel's principle for linear evolution equation
Denote $L$ a spatial linear differential operator (that is, involves no time derivative), and consider the **inhomogeneous linear evolution IVP of order $k$**: $$\begin{cases}\paren{\partial_t^k-L}u=f,&t>0\\\partial^l_tu(x,0)=0,&\forall l<k\end{cases}$$Set the auxiliary equations indexed by $s\in(0,\infty)$ as $$\begin{cases}\left(\partial_t^k-L\right)u^s=0,&t\in(s,\infty)\\\partial_t^lu^s(x,s)=0,&\forall l<k-1\\\partial_t^{k-1}u^s(x,s)=f(x,s)\end{cases}$$Denote the solution of auxiliary equation as $u^s(x,t)$, then the solution to the original equation is $$u(x,t)=\int_0^tu^s(x,t)ds$$**Proof**: assume that $u^s$ is the solution to the auxiliary equations. utilizing given initial values, by [[Differentiation Under the Integral Sign]] we have $$\begin{align}\partial_tu(x,t)&=\int_0^t\partial_tu^s(x,t)ds+u^t(x,t)=\int_0^t\partial_tu^s(x,t)ds\\\partial^2_tu(x,t)&=\int_0^t\pard{}{t^2}u^s(x,t)ds+\partial_tu^t(x,t)=\int_0^t\partial^2_tu^s(x,t)ds\\&\ \ \vdots\\\partial_t^{k-1}u(x,t)&=\int_0^t\partial_t^{k-1}u^s(x,t)ds+\partial_t^{k-2}u^t(x,t)=\int_0^t\partial_t^{k-2}u^s(x,t)ds\\\partial_t^{k}u(x,t)&=\int_0^t\partial_t^{k}u^s(x,t)ds+\partial_t^{k-1}u^t(x,t)=\int_0^t\partial_t^{k}u^s(x,t)ds+f(x,t)\end{align}$$Therefore by taking $t=0$ we can immediately verify the initial conditions of the original IVP. Moreover, since $L$ is purely spatial we have $$\begin{align}\paren{\partial_t^k-L}u&=\partial_t^ku-Lu\\&=\int_0^t\partial_t^{k}u_s(x,t)ds+f(x,t)-\int_0^tLu^s(x,t)ds\\&=\int_0^t\paren{\partial_t^k-L}u^s(x,t)ds+f(x,t)\\&=f\end{align}$$Therefore all equations are verified for the original IVP, completing the proof. 