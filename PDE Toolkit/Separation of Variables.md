The method of **separation of variable**is a method mainly for solving [[Linear PDE]] of the form $$\begin{cases}L\left(\dfrac{\partial}{\partial x},\dfrac{\partial}{\partial t }\right)u=f,& x\in\Omega\subseteq\mathbb R^n,t\in\mathbb R_+\\u|_{\partial D}=g,&t\in\mathbb R_+\\ u|_{t=0}=h,&x\in\Omega\end{cases}$$where $\Omega$ is generally assumed to be **bounded**. The key idea is to first identify the eigenbasis w.r.t the given differential operator and BV/IV, and then find the proper coefficients in the basis expansion using theory of [[Hilbert Space]] and [[Basis in Hilbert Space]]. 
- **Discussion**: a primary heuristic error in undergrad PDE course is that, $L$ is usually treated as a stand along entity, while BV/CV are extra information that prune solutions. That's a bad idea. Operator-theoretically (in functional analysis, in particular when we're dealing with [[Hilbert Space]]) an operator $T$ must always come with a **domain** $D(T)$ ([[Relation]]). In PDE this is realized exactly via BV/IC: $$(L,u|_{\partial D},u_{t=0})\qiffq(L,D(L))$$This restriction of domain $D(L)$ ensures that $L$ is self-adjoint and has a **discrete spectrum**, therefore the spectral method works well for us.
	- **Comparison with [[Solving Linear System]]**: these two things are essentially equivalent. For a [[Matrix]] $A\in F^{m\times n}$ consider the linear system of the form $$Ax=b$$We'll usually find the [[Eigendecomposition]] of the [[Vector Space]] w.r.t $A$, and then decompose $b$ into that basis to get the coefficients. Exactly the same thing happens to how we use PDE using spectral method. 
	- This method can be seen as a specific realization of the **spectra method**. 
- **Requirement for application**: there are several requirements imposed on the PDE to be solved so that SoV can be applied. 
	- **Separability of $L$**: we'll usually require that $L$ is of good shape (e.g., the [[Wave Equation]] or [[Heat Equation]]) so that spectrum can be calculated easily. 
	- **Bounded regular domain**: SoV only works for equations with $x$ variables defined on bounded domain $D$ that is regular enough. While it works well on one-sided-bounded rectangular domain, once there is some irregularity it would collapse. 
	- **Homogeneous boundary condition**: it's necessary that we have $$u|_{\partial\Omega}=0$$Without this condition the eigenfunctions in $x$ will be dependent on $t$, hence it's not possible for us to work out a set of eigenfunctions that serves us well. A common method for dealing with inhomogeneous BV is to add a simple balancing term, as discussed below. 
## Method
For a general [[Linear PDE]], taking practical calculation into consideration we'll usually proceed as follows. Note that in some cases we can rearrange the steps for optimal clarity and simplicity. 
1. **Find eigenfunctions**: we assume that the solution can be expressed as $$u(x)=T(t)X(x)\where X(x)=\prod_{i=1}^nX_i(x_i)$$and substitute it into the homogeneous version $Du=0$, and use the given boundary value condition to find eigenfunctions $X_i$ of the operator $D$, which will be denoted $$\Phi=\Set{X_\alpha(x):\alpha\in I}\where |I|\le|\mathbb N|\text{ is the index set}$$At this point we can also gain some basic information about $T$, but we'll not use it, though.
2. **Express the solution**: using the eigenfunctions we can now express the solution as $$u(x,t)=\sum_{\alpha\in I}T_\alpha(t)X_\alpha(x)$$This is the template of the final solution, and here $T_\alpha(t)$ is still assumed to be unknown. 
3. **Calculate $T_\alpha$**: by substituting the summation expression of $u(x,t)$ back we get $$D\left(\sum_{\alpha\in I}T_\alpha(t) X_\alpha(x)\right)=\sum_{\alpha\in I}D\left(T_\alpha(t)X_\alpha(x)\right)=f$$At this point we can usually get an expression with unknown constant  coefficients.
4. **Find the coefficients**: by substituting the expression obtained for $u$ in the last step into the initial condition (i.e., taking $t=0$) we get $$\sum_{\alpha\in I}T(0)X_\alpha(x)=g(x)$$We can usually calculate these coefficients using techniques from [[Basis in Hilbert Space]], in particular from [[Fourier Series]]. 
## SoV for wave equation on bounded domain
Consider the [[Wave Equation]] problem given by $$\begin{cases}u_{tt}-c^2u_{xx}=f(x,t),&x\in(0,l),t>0\\u(0,t)=u(l,t)=0,&t>0\\u(x,0)=g(x),u_t(x,0)=h(x),&x\in[0,l]\end{cases}$$Assume that the solution is of the form $$u(x,t)=X(x)T(t)$$then the original equation is transformed into $$XT''-c^2X\\T=0\quad\iff\quad\frac{T''}{c^2T}=\frac{X''}{X}\eqqcolon-\lambda$$while the BV is transformed into $$X(0)T(t)=X(l)T(t)=0\quad\Longrightarrow\quad X(0)=X(l)=0$$we call $\lambda$ that solves the problem as the **eigenvalue**, and those $X(x)$ as **eigenfunction**. The problem of solving eigenvalues and eigenfunctions itself is called a **Sturm-Liouville problem**.
**Theorem**: given $\alpha_i,\beta_i\ge0,\alpha_i+\beta_i\neq0$, for the S-L problem $$\begin{cases}X''+\lambda X=0,&x\in(0,l)\\-\alpha_1X'(0)+\beta_1X(0)=0\\\alpha_2X'(l)+\beta_2X(l)=0\end{cases}$$then we have the following results in order:
1. **Eigenvalues**: $\lambda\ge0$, and when $\beta_1+\beta_2>0$ we have $\lambda>0$.
2. **Distribution of Eigenvalues**: The set of eigenvalues $\set{\lambda_i}$, organized increasingly, satisfies: $$0\le \lambda_1<\lambda_2<\cdots,\quad\lim_{n\to\infty}\lambda_n=\infty$$that is, it converges to infinity.
3. **Orthogonal basis of eigenfunctions**: given $X_1,X_2$ corresponding to $\lambda_1\neq\lambda_2$ we have $$\int_0^lX_1X_2dx=0$$and further any $f\in L^2([0,l])$ can be represented as $$f=\sum_{n=1}^\infty C_nX_n\where C_n=\frac{\int_0^lfX_ndx}{\int_0^lX_n^2dx}$$Here convergence is in the sense of $L^2$ norm ([[Lp Space]]).
Some remarks are in order:
- **Homogeneous boundary condition**: it's necessary for SoV that the BV is homogeneous, i.e., $u(0,t)=u(l,t)=0$. Otherwise we need an extra substitution $$u(x,t)=v(x,t)+\frac{x}{l}u(0,t)+\frac{l-x}{l}u(l,t)$$Some concrete examples of homogenization is listed below.
	- Consider the problem $Lu=f$ with BV $$\begin{cases}(-u_x+\alpha u)|_{x=0}=\mu_1(t)\\(u_x+\beta u)|_{x=0}=\mu(t)\end{cases}$$then we consider introducing the auxiliary function via $$v(x,t)=u(x,t)+h(x,t)$$then we'd like that $$\begin{cases}(-u_x+\alpha u-h_x+\alpha h)|_{x=0}=0\\(u_x+\beta u+h_x+\beta h)|_{x=l}=0\end{cases}\quad\Longrightarrow\quad\begin{cases}(-h_x+\alpha h)|_{x=0}=-\mu_1(t)\\(h_x+\beta h)|_{x=l}=-\mu(t)\end{cases}$$hence we can write $$h(x,t)=(mx+n)\mu(t)+(px+q)\mu_1(t)$$and by substituting it back we could solve for $m,n,p,q$.
- **2D wave equation**: to deal with higher dimensional such as 2D wave equation $$u_{tt}-c^2(u_{xx}+u_{yy})=0$$we consider similarly the following separation of variables $$u(x,y,t)=X(x)Y(y)T(t)$$by substituting it into the original equation we get $$XYT''-c^2(X''YT+XY''T)=0\quad\Longrightarrow\quad \frac{T''}{c^2T}=\frac{X''}{X}+\frac{Y''}{Y}\eqqcolon-\lambda$$this yields the first ODE of $T$, and by assuming a second parameter $\mu$ into RHS we get $$\frac{T''}{c^2T}=-\lambda,\quad\frac{X''}{X}=-\mu,\quad\frac{Y''}{Y}=\mu-\lambda$$The rest are the same: we substitute BV to get eigenvalues $\lambda,\mu$, and work out a [[Fourier Series]] solution.
### Worked example
We consider the following wave equation problem $$\begin{cases}u_{tt}-c^2u_{xx}=0,&(x,t)\in Q\\u|_{x=0}=u_x|_{x=l}=0,&t\ge0\\u|_{t=0}=x(x-2l),u_t|_{t=0}=0\end{cases}$$by separation of variable the problem can be decomposed into two problems $$\begin{cases}X''+\lambda X=0,&x\in(0,l)\\X(0)=X'(l)=0\end{cases}\quad\text{and}\quad T''+c^2\lambda T=0$$the first equation solves to get $$\sqrt\lambda=\frac{(2n-1)\pi}{2l},\quad X=B\sin\frac{(2n-1)\pi x}{2l},\quad B\in\mathbb R$$hence we can assume that the solution is $$u(x,t)=\sum_{n=1}^\infty\left(A_n\cos\frac{(2n-1)c\pi t}{2l}+B_n\sin\frac{(2n-1)c\pi t}{2l}\right)\sin\frac{(2n-1)\pi x}{2l}$$at this point, we rewrite the initial conditions as $$u|_{t=0}=\sum_{n=1}^\infty A_n\sin\frac{(2n-1)\pi x}{2l}=x(x-2l),\quad u_t|_{t=0}=\sum_{n=1}^\infty\frac{(2n-1)c\pi}{2l}B_n\sin\frac{(2n-1)\pi x}{2l}=0$$from which we conclude that $$A_n=\frac{2}{l}\int_0^lx(x-2l)\sin\frac{(2n-1)\pi x}{2l}dx=-\frac{32l^3}{(2n-1)^3\pi^3},\quad B_n=0$$hence the final solution is $$u(x,t)=-\sum_{n=1}^\infty\frac{32l^3}{(2n-1)^3\pi^3}\cos\frac{(2n-1)c\pi t}{2l}\sin\frac{(2n-1)\pi x}{2l}$$
## SoV for heat equation on bounded domain
Consider the [[Heat Equation]] problem given by $$\begin{cases}u_t-\alpha\Delta u=0,&x\in[0,l],t\ge0\\u(x,0)=f(x),&x\in[0,l]\\u(0,t)=u(l,t)=0,&t\ge0\end{cases}$$We assume similarly as above that $u(x,t)=X(x)T(t)$, then we get $$\frac{T''}{\alpha T}=\frac{X''}{X}=-\lambda\quad\Longrightarrow\quad X(x)=B\sin\left(\sqrt\lambda x\right)+C\cos\left(\sqrt\lambda x\right),\quad T(t)=Ae^{-\lambda\alpha t}$$by substituting it into the IV and BV we can get the results. 