A **harmonic function** is a function $f\in C^2(\Omega),\Omega\subset\mathbb R^d$ satisfying the [[Laplace's Equation]] $$\Delta f=\sum\frac{\partial^2}{\partial x_i^2}f=0,\quad\forall x\in\Omega$$By definition the set of harmonic functions is $\ker \Delta$. Below we assume that the domain of definition $\Omega$ is simply connected, and restrict to $d=2$ when necessary.
- **Algebraic structure**: $\ker\Delta$ is closed under translation, dilation, and rotation by change of variable. Since partial derivatives commutes, we can construct new harmonic function as $\frac{\partial^\alpha}{\partial x^\alpha}u(x)$ when $u$ is harmonic.
- **Mean value property definition**: if $f\in C(\Omega)$ satisfies $$f(x)=\frac{1}{|\partial B_r(x)|}\int_{\partial B_r(x)}fdS,\quad\forall x\in\Omega,r>0,B_r(x)\subset\Omega$$then $f\in C^\infty(\Omega)$ and is harmonic on $\Omega$.
  **Proof**: apply $\Delta$ on both sides and then [[Differentiation Under the Integral Sign]] on RHS, after which Stokes' theorem ([[Calculus on Oriented Euclidean Space]]) can be used to concludes (notice that $\partial\partial B_r(x)=\varnothing$) that $\Delta f=0,\forall x$. 
- **Harmonic conjugate**: a harmonic $u$ uniquely determines a holomorphic $f$ up to an additive constant s.t. $\Re f=u$ (or $\Im f=u$). It can be calculated explicitly by $$f(z)=\int\frac{\partial f}{\partial z}dz=\int2\frac{\partial u}{\partial z}dz=\int (h_x-ih_y)dz$$the second equality is due to the property of wirtinger derivative, and holomorphicity of $h_x-ih_y$ is guaranteed by C-R equation and $\Delta f=0$ ([[Complex Function]]). The corresponding $v=\Im f$ is called the **harmonic conjugate** of $u$. 
- **Smoothness**: $f\in C^\infty$ given $\Delta f=0$. 
  **Proof**: take $\eta$ the standard [[Mollifier]], and let $u_\varepsilon=\eta_\varepsilon*u$ on $\Omega_\varepsilon=\set{x\in\Omega:d(x,\partial\Omega)>\varepsilon}$, then $u_\varepsilon\in C^\infty$ by [[Convolution]], while it can be verified by mean value property and polar coordinate integration ([[Measure]]) that $u_\varepsilon=u$ on $\Omega_\varepsilon$, hence $u\in C^\infty(\Omega)$.
## Mean value property
For harmonic $f$ by change of variable to polar coordinate and differentiation w.r.t $r$ we have $$f(x)=\frac{1}{|\partial B_r(x)|}\int_{\partial B_r(x)}fdS,\quad\forall x\in\Omega,r>0,B_r(x)\subset\Omega$$By Fubini's theorem for polar coordinate ([[Measure]]) we further get $$f(x)=\frac{1}{|B_r(x)|}\int_{B_r(x)}fdV,\quad\forall x\in\Omega,r>0,B_r(x)\subset\Omega$$We can also proceed backward by differentiation.
**Alternative proof**: by Stokes' theorem applied on $u\nabla v-v\nabla u$ we have the Green's identity $$\int_\Omega(u\Delta v-v\Delta u)=\int_{\partial\Omega}(u\nabla v-v\nabla u)d\vec S$$Now take $v=|x|^{2-n},\Omega=\set{\varepsilon<|x|<1}$ and let $\varepsilon\searrow 0$ to get the result.
- **Clustered zeros**: it's obvious that real-valued harmonic function has no isolated zero for $n\ge2$, otherwise mean value property must be contradicted.
	- Note however this doesn't apply to complex-valued ones, since holomorphic function has isolated zeros.
- **Maximum principle**: harmonic $f$ can only attain its maximum/minimum over $\overline\Omega$ on $\partial\Omega$, except the constant function.
  **Proof**: denote $\Sigma=\set{x\in\overline\Omega:f(x)=M}$, then $\Sigma$ is open by mean value property, and is closed relative to $\Omega$ by continuity, hence $\Sigma=\overline{\Omega}$ if $\Omega$ is connected.
	- **Identity principle**: harmonic function on connected $\Omega$ is uniquely determined by its boundary value, since $f-g=0,\forall x\in\partial\Omega$ implies $\max(f-g)=\min(f-g)=0$, i.e., $f-g\equiv0$. The exact expression is given by the Poisson integral formula below.
		- This is exactly the same reasoning as the maximum modulus principle ([[Complex Geometry]]). Note however the identity principle for [[Holomorphic Function]] is stronger than this, since it only requires a limit point rather than entire boundary.
- **Liouville's theorem**: if $f$ harmonic on $\mathbb R^d$ is bounded from above/below, then $f$ is constant.
  **Proof**: WLOG assume $f\ge0$. For any $x,y\in\mathbb R^d,r>0$ denote $R=r+d(x,y)$, and consider two balls $B_r(x),B_R(y)$. By monotonicity of integral $$f(x)=\frac{1}{|B_r|}\int_{B_r}f\le\frac{1}{|B_r|}\int_{B_R}f=\frac{|B_R|}{|B_r|}f(y)$$Since $|B_R|/|B_r|\to1,r\to\infty$ we have $f(x)\le f(y)$. The converse also holds, hence $f(x)=f(y)$.
	- **Intuition**: the inspiration comes from the case for bounded harmonic function, in which we could consider $B_R(x),B_R(y)$ and let $R\to\infty$ to deduce that $f(x)=f(y)$ directly. For one-side boundedness we use translation to ensure $f\ge0$, introducing tools of monotonicity for us.
## Poisson integral formula
Denote $B=B_r(0)\subset\mathbb R^d$ the ball centered at $0$ with radius $r$, we have $$f(x)=\int_{\partial B}f(t)P(x,\zeta)d\sigma(\zeta),\quad P(x,\zeta)=\frac{1-|x|^2}{|x-\zeta|^n}\quad\forall x\in B$$**Proof**: it's easy to verify that $v(y)=|y-x|^{2-n}-|x|^{2-n}|y-(x/|x|)|^{2-n}=0$. Take this $v$ into Green's identity and simply using mean value property we get $P(x,\zeta)=(2-n)^{-1}\nabla v(\zeta)$, which can be further simplified into the expression above.
- **Harmonic continuation**: Poisson's integral formula actually constructs a harmonic continuation for any continuous $u(e^{i\theta})$ (by differentiation under the integral sign), and the radial limit equals the boundary value for any direction (by approximation to the identity property of Poisson kernel [[Convolution]]). 
## Other properties
Denote $u$ the harmonic function on $\Omega$, and $f=u+iv\in\mathcal O(\Omega)$ the corresponding holomorphic function induced by $u$, with $v$ being its harmonic conjugate.
- **Fourier series representation**: for $d=2$ taking the real part in the Laurent series of $f$ ([[Holomorphic Function]]) we get $$u(re^{i\theta})=a_0+\sum_{n=1}^\infty r^n(a_n\cos n\theta+b_n\sin n\theta)$$the coefficients can be calculated from $f$.
- **Harmonic function with sub-logarithmic growth rate**: if harmonic $f:\mathbb R^2\to\mathbb R$ satisfies $$\lim_{|x|\to\infty}\frac{|f(x)|}{\ln |x|}=0$$then $f$ is constant.
  **Proof**: for $f(r,\theta)=a_0+\sum_{n=1}^\infty(a_nr^n\cos n\theta+b_nr^n\sin n\theta)$ notice that if there exists $n>0$ s.t. $a_n\neq0$ (or $b_n\neq0$) then we can pick proper $(r,\theta)$ pair sequence such that the limit is violated, hence we must have $a_n=b_n=0,\forall n\neq0$, i.e., $f\equiv a_0$ is constant.
- **Uniform limit of harmonic functions**: for $f_n$ harmonic and $f_n\to f$ uniformly on compact set, then $f$ is also harmonic.
  **Proof1**: by uniform convergence $f$ satisfies the Poisson integral formula (or mean value property), hence is harmonic.
## Laplacian
**Polar form of $\Delta$**: by [[Differential Calculus on Euclidean Space]] when $d=2$ the polar form is $$\Delta=\frac{1}{r}\frac{\partial f}{\partial r}\left(r\frac{\partial f}{\partial r}\right)+\frac{1}{r^2}\frac{\partial^2 f}{\partial\theta^2}=\frac{\partial^2}{\partial r^2}+\frac{1}{r}\frac{\partial}{\partial r}+\frac{1}{r^2}\frac{\partial^2}{\partial\theta^2}$$For general $d\in\mathbb N$ the form is $$\Delta=\frac{\partial^2 f}{\partial r^2}+\frac{N-1}{r}\frac{\partial}{\partial r}+\frac{1}{r^2}\Delta_{S^{d-1}},\quad\Delta_{S^{d-1}}f(x)=\Delta f(x/|x|)$$We call $\Delta_{S^{d-1}}$ the Laplace-Beltrami operator on $S^{d-1}$.
Another definition using mean value is that $$\Delta f(x)=\lim_{R\to0}\frac{2n}{R^2}\left(\frac{1}{A_n}\int_{S_R}f(r)d\sigma-f(x)\right)$$where $A_n$ the hyper-area of $n$-sphere $S_R$. This can be verified using Taylor's theorem, as the only integrals that do not vanish on $S_R$ are those $\int x_i^2dS$ terms.
- **Product rule**: $\Delta(fd)=f\Delta g+2\nabla f\cdot\nabla g+g\Delta f$.
- **Averaging property**: we have that $$\overline f_S(p,h)=f(p)+\frac{\Delta f(p)}{2n}h^2+o(h^2)\quad\text{for}\quad h\to0$$which is obtained by rearranging the terms in the definition, or applying Stoke's theorem in the differentiation of $\overline f_S$. [[Integral Calculus on Smooth Manifold]]