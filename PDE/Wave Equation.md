The homogeneous 1D **wave equation** is of the form $$u_{tt}=c^2 u_{xx}\iff\left(\frac{\partial}{\partial t}-c\frac{\partial}{\partial x}\right)\left(\frac{\partial}{\partial t}+c\frac{\partial}{\partial x}\right)u=0$$A general BVP of (inhomogeneous) wave equation is like $$\begin{cases}u_{tt}-c^2u_{xx}=f(x,t)\\u(x,0)=g(x)\\u_t(x,0)=h(x)\end{cases}$$for $-\infty<x<\infty,t>0$ with $f\in C^2(\mathbb R^2)$.
- **n-dimensional wave equation**: the general wave equation in n-dimensional space is $$u_{tt}=c^2\left(u_{rr}+\frac{n-1}{r}u_r\right)$$If we want the solution to be of the form $u(r,t)=\alpha(r)f(t-\beta(r))$ where $\alpha(t)$ is the attenuation and $\beta(t)$ the delay, then we must have $n=3$.
- **Reduction of problem**: assuming that $u_h=M_h(x,t)$ is the solution of the Cauchy problem of wave equation with $f=g=0$, then the solution to Cauchy problem with $f=h=0$ and $g=h=0$ are be expressed, respectively, as $$u_g=\frac{\partial}{\partial t}M_g(x,t),\quad u_f=\int_0^t M_{f_\tau}(x,t-\tau)d\tau$$this can be verified directly. More can be found in [[Duhamelâ€™s Principle]]. 
- **d'Alembert formula**: the solution to the above BVP is given by $$u(x,t)=\frac{1}{2}\left(g(x+ct)+g(x-ct)\right)+\frac{1}{2c}\int_{x-ct}^{x+ct}h(\xi)d\xi+\frac{1}{2c}\int_0^td\tau\int_{x-c(t-\tau)}^{x+c(t-\tau)}f(\xi,\tau)d\xi$$To ensure that it's indeed a solution some smoothness constraints are needed. This can be derived via exactly the same methods as below.
Below we look at some basic methods for solving 1D wave equations.
## d'Alembert formula (method of waves)
By theory of [[Linear PDE]] we can consider the transformation $$\begin{cases}\mu=x+ct\\\eta=x-ct\end{cases}\quad\Longrightarrow\quad u_{tt}-c^2u_{xx}=u_{\mu\eta}$$and the general solution for the second equation, via direct integration, is $$u(\mu,\eta)=F(\mu)+G(\eta),\quad F,G\in C^1$$hence the general solution to the original equation would be $$u(x,t)=F(x+ct)+G(x-ct),\quad F,G\in C^1$$now the corresponding constraints on $F,G$ by BV are $$\begin{cases}F(x)+G(x)=g(x)\\ cF'(x)-cG'(x)=h(x)\end{cases}$$and by solving this [[Linear ODE System]] we get $$\begin{align}F(x)&=\frac{1}{2c}\left(cg(x)+\int_{-\infty}^xh(\xi)d\xi+C_1\right)\\G(x)&=\frac{1}{2c}\left(cg(x)-\int_{-\infty}^xh(\xi)d\xi+C_1\right)\end{align}$$and combining the above we finally get $$u(x,t)=\frac{1}{2}\left(g(x-ct)+g(x+ct)\right)+\frac{1}{2c}\int_{x-ct}^{x+ct}h(\xi)d\xi$$which is referred to as the (homogeneous) **d'Alembert formula**.
- **Special BV**: we use the second worked example in [[Method of Characteristics]] to illustrate how d'Alembert formula is used when confronted with special BV. The BVP is $$\begin{cases}u_{tt}-u_{xx}=0,&x\in\mathbb R,t>at\\u|_{t=ax}=u_0(x),&x\in\mathbb R\\ u_t|_{t=ax}=u_1(x),&x\in\mathbb R\end{cases}$$By d'Alembert formula, the solution is given by $$u(x,t)=F(x+t)+G(x-t)\quad\text{with}\quad\begin{cases}F(x+ax)+G(x-ax)=u_0(x)\\ F'(x+ax)-G'(x-ax)=u_1(x)\end{cases}$$Now differentiating the first BV and combine it with the second, then we get $$\begin{align}F'(x+ax)&=\frac{1}{2}u_0'(x)+\frac{1-a}{2}u_1(x)\\G'(x-ax)&=\frac{1}{2}u_0'(x)-\frac{1+a}{2}u_1(x)\end{align}$$Perform a simple change of variable and integrate, and then substitute them back into the d'Alembert formula, we get $$u(x,t)=\frac{1+a}{2}u_0\left(\frac{x+t}{1+a}\right)+\frac{1-a}{2}u_0\left(\frac{x-t}{1-a}\right)+\frac{1-a^2}{2}\int_\frac{x-t}{1-a}^\frac{x+t}{1+a}u_1(s)ds+C$$imposing the first BV we get $C=0$, hence we get the same solution.
## Other methods
Consider the wave equation with source $$u_{tt}-c^2u_{xx}=f(x,t),\quad u(x,0)=\phi(x), u_t(x,0)=\psi(x)$$we'll derive the following unique solution$$u(x,t)=\frac{1}{2}(\phi(x+ct)+\phi(x-ct))+\frac{1}{2c}\int_{x-ct}^{x+ct}\psi+\frac{1}{2c}\int_\triangle f$$where $\triangle$ is the characteristic triangle determined by points $(x,t),(x-ct,0),(x+ct,0)$.
- **Operator method**: the analogous ODE is $u''+A^2u=f(t),u_0=\phi,u'(0)=\psi$, whose solution is of the form $u(t)=S'(t)\phi+S(t)\psi+\int_0^tS(t-s)f(s)ds$ with $S(t)=A^{-1}\sin At$. We define the **source operator** $$\mathcal J(t)\psi=\frac{1}{2c}\int_{x-ct}^{x+ct}\psi(y)dy=v(x,t)$$where $v(x,t)$ solves the initial condition $f=\phi=0$. Now the term for $\phi$ is expected to be $\partial_t\mathcal J(t)\phi$, and the term for $f$ to be $$u(t)=\int_0^t\mathcal J(t-s)f(s)ds=\frac{1}{2c}\int_\triangle fdxdt$$which matches the solution.
- **Wave equation with boundary condition**: for a finite interval, we consider the conditions $u(0,t)=u(l,t)=0,u(x,0)=\phi(x),u_t(x,0)=\psi(x)$. We guess a **separated solution** of the form $u(x,t)=X(x)T(t)$. Similar to what we've done in [[Diffusion Equation]], we have that $$X(x)=C\cos\beta x+D\sin\beta x,\quad T(t)=A\cos\beta ct+B\sin\beta ct$$Imposing the boundary condition we find $C=0,\beta l=n\pi$, thus we have infinite solutions $$u_n(x,t)=\left( A_n\cos\frac{n\pi ct}{l}+B_n\sin\frac{n\pi ct}{l}\right)\sin\frac{n\pi x}{l},\quad n\in\mathbb Z_+$$Thus any finite linear combination is a solution for the boundary condition. Further imposing the initial condition, the coefficients can be specified with $$\phi(x)=\sum_n A_n\sin\frac{n\pi x}{l},\quad\psi(x)=\sum_n\frac{n\pi c}{l}B_n\sin\frac{n\pi x}{l}$$
	- **Frequency**: in the general solution each $n$ corresponds to a specific ratio $\beta^2=-X''/X$. We call the coefficients $n\pi c/l$ the frequencies.
---
Below we discuss the methods for solving wave equations of **higher dimension**. 
## Method of spherical means
This method is used to solve the wave equation in $\mathbb R^n\times\mathbb R$ with $2\not\mid n$.
Assuming that $u$ solves the BVP of wave equation in dimension $n$: $$\begin{cases}u_{tt}-c^2\Delta u=f(x,t),&x\in\mathbb R^n,t\ge0\\ u(x,0)=g(x)\\u_t(x,0)=h(x)\end{cases}$$ Define the average integral over the ball as$$\overline u(x,r,t)=\avint{\partial B(x,r)}u(y,t)dS(y)$$then we claim that the above function solves the **Euler-Poisson-Darboux equation** $$\begin{cases}\overline u_{tt}-\overline u_{rr}-\dfrac{n-1}{r}\overline u_r=0,&x\in\mathbb R^n,t\ge0\\\overline u(x,r,0)=\overline g(x,r)=\avint{\partial B(x,r)}g(t)dS(y)\\\overline u_t(x,r,0)=\overline h(x,r)=\avint{\partial B(x,r)}h(y)dS(y)\end{cases}$$**Proof**: By definition, we have $$\overline u(x,r,t)=\avint{\partial B(x,r)}u(y,t)dS(y)=\avint{\partial B(0,1)}u(x+rz,t)dS(z)$$Now utilizing the Gauss-Green theorem ([[Integral Calculus on Euclidean Space]]) we have $$\begin{align}\overline u_r(x,r,t)&=\avint{\partial B(0,1)}\nabla u(x+rz,t)\cdot zdS(z)\\&=\avint{\partial B(x,r)}\nabla u(y,t)\cdot\frac{y-x}{r}dS(y)\\&=\avint{\partial B(x,r)}\frac{\partial u}{\partial\nu}(y,t)dS(y)\\&=\frac{1}{n\alpha(n)r^{n-1}}\int_{\partial B(x,r)}\frac{\partial u}{\partial\nu}(y,t)dS(y)\\&=\frac{1}{n\alpha(n)r^{n-1}}\int_{B(x,r)}\nabla u(y,t)dy\\&=\frac{1}{n\alpha(n)r^{n-1}}\int_{B(s,r)}u_{tt}(y,t)dy\end{align}$$Now using the fact that $u_{tt}-\nabla u=0$ we have $$\overline u_r(x,r,t)=\frac{1}{n\alpha(n)r^{n-1}}\int_{B(x,r)}u_{tt}(y,t)dy$$therefore by some straightforward calculation we can verify that $$(r^{n-1}\overline u_r(x,r,t))_r=r^{n-1}\overline u_{tt}(x,r,t)$$which further simplifies into $$\overline u_{tt}-\overline u_{rr}-\frac{n-1}{r}\overline u_r=0$$the boundary conditions can be deduced directly. 
- **Application in 3D case**: for $n=3$ the above BVP becomes $$\begin{cases}v_{tt}-v_{rr}=0,&r>0,t\ge0\\ v(x,r,0)=\phi(x,r),&r>0\\v_t(x,r,0)=\psi(x,r),&r>0\\v(x,0,t)=0,&t\ge0\end{cases}\quad\text{where}\quad\begin{cases}v=r\overline u\\\phi=r\overline g\\\psi=r\overline h\end{cases}$$hence we can apply the d'Alembert's formula to get $$v(x,r,t)=\frac{1}{2}\left(\phi(x,t+r)-\phi(x,t-r)\right)+\frac{1}{2}\int_{t-r}^{t+r}\psi(x,y)dy$$by smoothness assumption we have $$u(x,t)=\lim_{r\searrow0}\overline u(x,r,t)$$now substituting every back into the above expression, and after some complicated but straightforward calculation we have $$u(x,t)=\frac{\partial}{\partial t}\left(t\avint{\partial B(x,ct)}gdS\right)+t\avint{\partial B(x,ct)}hdS+\int_0^t\left((t-\tau)\avint{\partial B(x,c(t-\tau))}f(y,\tau)dS\right)d\tau$$which is referred to as the **Poisson's formula**. If $g$ is smooth enough, we can further simplify it into $$u(x,t)=\frac{1}{4\pi t^2}\int_{\partial B(x,t)}\left(g(y)+\nabla g(y)\cdot(y-x)+th(y)\right)dS(y)$$which is referred to as the **Kirchhoff's formula**.
## Method of descent
This method is used, on the basis of the Kirchhoff's formula derived above, to obtain the solution to wave equation in even dimension. The key idea is to first add an extra dimension so that Kirchhoff's formula can be apply, and then eliminate it away. Below use the derivation of solution in 2D case to illustrate this method.
To solve the BVP in $\mathbb R^2$ given by $$\begin{cases}u_{tt}-\Delta u=0,&x\in\mathbb R^2,t\ge0\\ u(x,0)=g(x)\\u_t(x,0)=h(x)\end{cases}$$we define $$\tilde u(x_1,x_2,x_3,t)=u(x_1,x_2,t)$$and similarly find the corresponding boundary values. Clearly $\tilde u$ is a solution to the 3D wave equation with BV $\tilde g,\tilde h$, hence is given by $$\tilde u=\avint{\partial\tilde B(\tilde x,t)}\left(\tilde g(y)+\nabla\tilde g\cdot(y-x)+t\tilde h(y)\right)dS(y)$$by assumption and [[Integral Calculus on Euclidean Space]] we get the **Poisson formula for 2D wave equation** $$u(x,t)=\frac{1}{2\pi c}\frac{\partial}{\partial t}\int_{B(x,ct)}\frac{g(y)}{\sqrt{c^2t^2-\|y-x\|_2^2}}dy+\frac{1}{2\pi c}\int_{B(x,ct)}\frac{h(y)}{\sqrt{c^2t^2-\|y-x\|_2^2}}dy+\underset{\text{the term involving }f}{\cdots}$$More discussion on general $\mathbb R^n$ case can be found in this [course note](https://web.stanford.edu/class/math220a/handouts/waveequation3.pdf)

---
## Weak solution
See [[Weak Solution]] for general discussion.
**Weak formulation**: consider the wave equation on $Q_T=[0,l]\times[0,T]$. Multiplying $\zeta$ yields $$\int_{Q_T}(u_{tt}-c^2u_{xx})\zeta dxdt=0$$via integration by parts ([[Integral Calculus on Euclidean Space]]) we have $$\int_{Q_T}u(\zeta_{tt}-c^2\zeta_{xx})dxdt+\int_0^l(u_t\zeta-u\zeta_t)|_0^Tdx-c^2\int_0^T(u_x\zeta)|_0^ldt=0$$if we assume that $\zeta(x,T)=\zeta_t(x,T)=\zeta(0,t)=\zeta(l,t)=0$, then the above is simplified into $$\int_{Q_T}u(\zeta_{tt}-c^2\zeta_{xx})dxdt+\int_0^lg\zeta_t(x,0)dx-\int_0^lh\zeta dx=0$$we say that $u$ is a weak solution if the above holds for all **test functions** $$\zeta\in\Set{\zeta\in C^2(\overline Q_T):\zeta(x,T)=\zeta_t(x,T)=\zeta(0,t)=\zeta(l,t)=0}$$more general discussion on test function can be found in [[Distribution]] and [[Schwartz Space]].
- **Uniqueness**: assume that two weak solutions $u_1,u_2$ exist, and by subtraction we have $$\int_{Q_T}(u_1-u_2)L\zeta dxdt=0\where L=\frac{\partial^2}{\partial t^2}-c^2\frac{\partial^2}{\partial x^2}$$If we pick any $\phi\in C_c^\infty(Q_T)$, then the problem $L\zeta=\phi$ with corresponding BV has a solution, which means the above holds for any $\phi\in C_c^\infty(Q_T)$, further implying $u_1=u_2$ by [[Lebesgue Integral]]. 
- **Stability**: 
- **Existence**: write the [[Fourier Series]] of $g,h$ as $$g(x)=\sum_{n=1}^\infty g_n\sin\frac{n\pi}{l}x,\quad h(x)=\sum_{n=1}^\infty h_n\sin\frac{n\pi}{l}x$$denote $S_N,T_N$ the corresponding partial sum, then by assumption we have $$\|g-S_N\|_2\to0,\quad\|h-T_N\|_2\to0$$if $g,h$ in the BV is replace by $S_N,T_N$, then we know that the problem has a unique solution as $$u_N(x,t)=\sum_{n=1}^N\left(A_n\sin\frac{an\pi}{l}t+AB_n\cos\frac{an\pi}{l}t\right)\sin\frac{n\pi}{l}x\where A_n=\frac{l}{an\pi}h_n,\quad B_n=g_n$$now multiplying $\zeta$ and integrate by parts as above, then we can easily verify that after taking $N\to\infty$ the limit is exactly the weak formulation.