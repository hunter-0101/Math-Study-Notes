Consider the 1D diffusion equation $$u_t=ku_{xx},\quad k>0$$We'll first look at the solution on a finite interval, and the go to the whole real line.
- **Maximum principle**: for a solution $u(x,t)$ to the above equation in a rectangle $[0,l]\times[0,T]$ in space-time, the maximum of $u$ is assumed either at $t=0$ or on $x=0,l$.
  **Proof**: Let $M$ be the maximum value of $u$ on three sides, and set $$v(x,t)=u(x,t)+\epsilon x^2,\quad\epsilon>0$$If we manage to proof $v\le M+\epsilon l^2$, then the conclusion follows from the fact that $\epsilon$ is arbitrary. Now for this $v$, the inequality already holds for the sides. For interior of the rectangle, we have the **diffusion inequality**:$$v_t-kv_{xx}=u_t-k(u+\epsilon x^2)_{xx}=u_t-ku_{xx}-2\epsilon k<0$$if $v$ reaches maximum at $(x_0,t_0)$, then $v_t=0,v_{xx}<0$, contradiction. If $(x_0,t_0)$ lies at the top of the rectangle ($t_0=T$), then $v_x(x_0,t_0)=0.v_{xx}(x_0,t_0)\le0,v_t(x_0,t_0)\ge0$. This is again a contradiction. 
- **Uniqueness for Dirichlet problem for diffusion equation**: consider $$u_t-ku_{xx}=f(x,t),\quad u(x,0)=\phi(x),\quad u(0,t)=g(t),u(l,t)=h(t)$$for given $f,\phi,g,h$. For two solutions $u_1,u_2$, set $w=u_1-u_2$, then $w$ also satisfy another Dirichlet problem in which $f,\phi,g,h=0$. By maximum principle $w\le0$, and if we reverse the subtraction we have $-w\le0$, yielding $w=0$.
	- **Proof with energy method**: consider multiplying $w$ on both sides:$$0=0\cdot w=(w_t-kw_{xx})w=\frac{1}{2}(w^2)_t+(-kw_xw)_x+kw_x^2$$Now integrate both sides on $0<x<l$, by the boundary conditions we have$$\frac{d}{dt}\int_0^l\frac{1}{2}w^2dx=-k\int_0^lw_x^2dx\le0$$therefore we get $$\int_0^lw^2dx\le\int_0^lw^2(x,0)dx=0,\quad\forall t>0$$thus we have $w=0,\forall t>0$.
> [!info] The energy method
> For a Dirichlet problem of the form $$\begin{cases}\mathcal Lu=f(x,t)&\text{on }I\\\text{initial conditions}&\text{on }I\\\text{boundary conditions}&\text{for }t>0\end{cases}$$where $\mathcal L$ is linear, let $u$ be a solution, then the general procedure for proofing the uniqueness is as follows:
> 1. Multiply the equation by $u$ for diffusion equation, or by $u_t$ for wave equation.
> 2. Integrate both sides over the interval $I$.
> 3. Use integration by parts and the boundary condition to rewrite some terms.
> Then we usually find a quantity of the form $$\mathcal E(t)=\int_0^L e(x,t)dx$$which is constant or non-increasing, and whose value at $t=0$ depends only on the initial condition. With these information it's usually possible to deduce an uniqueness theorem by applying the above steps to $w=u_1-u_2$.
- **Stability**: the above energy method would lead to a square integral stability$$\int_{0}^l(u_1-u_2)^2dx\le\int_0^l(\phi_1(x)-\phi_2(x))^2dx$$while using the maximum principle we will reach stability in the uniform sense$$\max_{0\le x\le l}|u_1-u_2|\le\max_{0\le x\le l}|\phi_1(x)-\phi_2(x)|$$
- **Solution on a finite interval**: to solve the heat equation on a finite interval, consider the solution of the form $u(x,t)=X(x)T(t)$. Plugging it into the equation yields $$X(x)T'(t)=kX''(x)T(t)\iff k\frac{X''}{X}=\frac{T'}{T}=\sigma\text{ for some }\sigma\in\mathbb R$$solving the two ODEs yields two possible solutions to the original PDE$$\begin{align}&u(x,t)=(d_1e^{\sqrt\sigma x}+d_2e^{-\sqrt\sigma x})(d_3e^{k\sigma t})\\&u(x,t)=(d_1+d_2x)d_3\end{align}$$Impose the initial and boundary condition would yields the solution. Note that this method cannot be applied to the equation on the whole real line, as the boundary condition is absent.
- **Solution on the whole line**: consider the Dirichlet problem $$\begin{align}u_t&=ku_{xx}\quad(-\infty<x<\infty,0<t<\infty)\\u(x,0)&=\phi(x)\end{align}$$We need the following **invariance properties** of solution to diffusion equation: for $u(x,t)$ a solution, any **translation** $u(x-y,t)$, any **derivative** $u_x,u_t,u_{xx}$, etc., any **linear combination**, the **integral** $\int_{-\infty}^{\infty}u(x-y,t)g(y)dy$ ($g(y)$ an arbitrary function that makes the integral converges), and the **dilated function** $u(\sqrt ax,at)$, are all solutions.
	1. Consider $\phi(x)=H(x)$ the Heaviside step function. We'll look for solutions of the form $$H(x,t)=g(p)\quad\text{where}\quad p=\frac{x}{\sqrt{4kt}}$$We choose this form because $H(x)$ is invariant under dilation, thus the solution should also be invariant, which means it must be of the above form. $\sqrt{4k}$ is for simplicity later.
	2. Using invariance under differentiation, we have $$0=H_t-kH_{xx}=\frac{1}{t}\left(-\frac{1}{2}pg'(p)-\frac{1}{4}g''(p)\right)\quad\Longrightarrow\quad g''+2pg'=0$$Solving the ODE we get $$H(x,t)=c_1\int e^{-p^2}dp+c_2$$Now apply the initial condition of $H(x)$ we get $c_1=\frac{1}{\sqrt\pi},c_2=\frac{1}{2}$.
	3. We let $S(x,t)=\partial H/\partial x$, which is also a solution, and define $$u(x,t)=\int_{-\infty}^\infty S(x-y,t)\phi(y)dy,\quad t>0$$we can directly verify that $u(x,t)$ is the **unique solution** to the initial condition $\phi(x)$. Explicitly, we have $$S(x,t)=\frac{\partial H}{\partial x}=\frac{1}{2\sqrt{\pi kt}}e^{-x^2/4kt},\quad t>0$$and the expression for the solution is $$u(x,t)=\frac{1}{\sqrt{4\pi kt}}\int_{-\infty}^\infty e^{-(x-y)^2/4kt}\phi(y)dy$$
	**Remark**: in the above process we basically start with a very simple function $H(x)$, find the corresponding solution, and then extends to the general case. This is very similar to what we did in [[Riemann Integral]] and [[Lebesgue Integral]].
	- **Fundamental solution**: the above $S(x,t)$ is known as the [[Fundamental Solution]] of the diffusion equation, or simply the **diffusion kernel**. Note that $$\int_\mathbb R S(x,t)dx=\frac{1}{\sqrt\pi}\int_\mathbb Re^{-q^2}dq=1$$by substituting $1=x/\sqrt{4kt}$, thus $\lim_{t\to\infty}S(x,t)=\delta(x)$ ([[Special Function Gallery]]). The same idea is applied in [[Linear ODE#Variation of parameters]].
	- **Error function**: it's usually impossible to evaluate the integral for $u(x,t)$ in terms of elementary functions. Answer to particular $\phi(x)$ is sometimes expressed in terms of the error function of statistics $$\operatorname{erf}(x)=\frac{2}{\sqrt\pi}\int_0^xe^{-p^2}dp$$Say, $H(x,t)=\frac{1}{2}+\frac{1}{2}\operatorname{erf}\left(\frac{x}{\sqrt{4kt}}\right)$. Notice that $\operatorname{erf}(0)=0,\lim_{x\to+\infty}\operatorname{erf}(x)=1$.
- **Solution on the half line**: to find the solution on the half line we consider the extension of $\phi(x)$ and apply the solution formula. Note that the boundary conditions determines what extension we would choose, say, $\phi_{\text{odd}}(x)$ or $\phi_{\text{even}}(x)$, i.e..
- **Solution with a source**: consider the inhomogeneous equation$$u_t-ku_{xx}=f(x,t),\quad u(x,0)=\phi(x)$$We can directly verify that the function below is exactly the solution to above equation $$u(x,t)=\int_\mathbb RS(s-y,t)\phi(y)dy+\int_0^t\int_\mathbb RS(x-y,t-s)f(y,s)dyds$$Note that this is analogous to the solution to inhomogeneous [[First Order ODE]] using the method of integrating factor. We define an operator $\mathcal J(t)$ as $(\mathcal J(t)\phi)(x)=\int_{\mathbb R}S(x-y,t)\phi(y)dy$, and in PDE we call this method the **operator method**.
	- **Source on the boundary**: for more complicated problem like the boundary source $u(0,t)=h(t)$ or $u_x(0,t)=h(t)$ we consider the method of subtraction: define $U(x,t)=u(x,t)-h(t)$ or $U(x,t)-u(x,t)-xh(t)$ (depending on the condition), and putting it back we can eliminate the boundary source.