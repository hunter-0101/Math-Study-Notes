The method of **separation of variable** is a method mainly for solving [[Linear PDE]]. It relies on the theory of [[Fourier Series]] to decompose the solution into trigonometric functions, and recover the solution to an BVP by working out the Fourier coefficient.
## SoV for wave equation on bounded domain
Consider the [[Wave Equation]] problem given by $$\begin{cases}u_{tt}-c^2u_{xx}=f(x,t),&x\in(0,l),t>0\\u(0,t)=u(l,t)=0,&t>0\\u(x,0)=g(x),u_t(x,0)=h(x),&x\in[0,l]\end{cases}$$Assume that the solution is of the form $$u(x,t)=X(x)T(t)$$then the original equation is transformed into $$XT''-c^2X\\T=0\quad\iff\quad\frac{T''}{c^2T}=\frac{X''}{X}\eqqcolon-\lambda$$while the BV is transformed into $$X(0)T(t)=X(l)T(t)=0\quad\Longrightarrow\quad X(0)=X(l)=0$$we call $\lambda$ that solves the problem as the **eigenvalue**, and those $X(x)$ as **eigenfunction**. The problem of solving eigenvalues and eigenfunctions itself is called a **Sturm-Liouville problem**.
**Theorem**: given $\alpha_i,\beta_i\ge0,\alpha_i+\beta_i\neq0$, for the S-L problem $$\begin{cases}X''+\lambda X=0,&x\in(0,l)\\-\alpha_1X'(0)+\beta_1X(0)=0\\\alpha_2X'(l)+\beta_2X(l)=0\end{cases}$$then we have the following results in order:
1. **Eigenvalues**: $\lambda\ge0$, and when $\beta_1+\beta_2>0$ we have $\lambda>0$.
2. **Distribution of Eigenvalues**: The set of eigenvalues $\set{\lambda_i}$, organized increasingly, satisfies: $$0\le \lambda_1<\lambda_2<\cdots,\quad\lim_{n\to\infty}\lambda_n=\infty$$that is, it converges to infinity.
3. **Orthogonal basis of eigenfunctions**: given $X_1,X_2$ corresponding to $\lambda_1\neq\lambda_2$ we have $$\int_0^lX_1X_2dx=0$$and further any $f\in L^2([0,l])$ can be represented as $$f=\sum_{n=1}^\infty C_nX_n\where C_n=\frac{\int_0^lfX_ndx}{\int_0^lX_n^2dx}$$Here convergence is in the sense of $L^2$ norm ([[Lp Space]]).
Some remarks are in order:
- **Homogeneous boundary condition**: it's necessary for SoV that the BV is homogeneous, i.e., $u(0,t)=u(l,t)=0$. Otherwise we need an extra substitution $$u(x,t)=v(x,t)+\frac{x}{l}u(0,t)+\frac{l-x}{l}u(l,t)$$Some concrete examples of homogenization is listed below.
	- Consider the problem $Lu=f$ with BV $$\begin{cases}(-u_x+\alpha u)|_{x=0}=\mu_1(t)\\(u_x+\beta u)|_{x=0}=\mu(t)\end{cases}$$then we consider introducing the auxiliary function via $$v(x,t)=u(x,t)+h(x,t)$$then we'd like that $$\begin{cases}(-u_x+\alpha u-h_x+\alpha h)|_{x=0}=0\\(u_x+\beta u+h_x+\beta h)|_{x=l}=0\end{cases}\quad\Longrightarrow\quad\begin{cases}(-h_x+\alpha h)|_{x=0}=-\mu_1(t)\\(h_x+\beta h)|_{x=l}=-\mu(t)\end{cases}$$hence we can write $$h(x,t)=(mx+n)\mu(t)+(px+q)\mu_1(t)$$and by substituting it back we could solve for $m,n,p,q$.
- **2D wave equation**: to deal with higher dimensional such as 2D wave equation $$u_{tt}-c^2(u_{xx}+u_{yy})=0$$we consider similarly the following separation of variables $$u(x,y,t)=X(x)Y(y)T(t)$$by substituting it into the original equation we get $$XYT''-c^2(X''YT+XY''T)=0\quad\Longrightarrow\quad \frac{T''}{c^2T}=\frac{X''}{X}+\frac{Y''}{Y}\eqqcolon-\lambda$$this yields the first ODE of $T$, and by assuming a second parameter $\mu$ into RHS we get $$\frac{T''}{c^2T}=-\lambda,\quad\frac{X''}{X}=-\mu,\quad\frac{Y''}{Y}=\mu-\lambda$$The rest are the same: we substitute BV to get eigenvalues $\lambda,\mu$, and work out a [[Fourier Series]] solution.
### Worked example
We consider the following wave equation problem $$\begin{cases}u_{tt}-c^2u_{xx}=0,&(x,t)\in Q\\u|_{x=0}=u_x|_{x=l}=0,&t\ge0\\u|_{t=0}=x(x-2l),u_t|_{t=0}=0\end{cases}$$by separation of variable the problem can be decomposed into two problems $$\begin{cases}X''+\lambda X=0,&x\in(0,l)\\X(0)=X'(l)=0\end{cases}\quad\text{and}\quad T''+c^2\lambda T=0$$the first equation solves to get $$\sqrt\lambda=\frac{(2n-1)\pi}{2l},\quad X=B\sin\frac{(2n-1)\pi x}{2l},\quad B\in\mathbb R$$hence we can assume that the solution is $$u(x,t)=\sum_{n=1}^\infty\left(A_n\cos\frac{(2n-1)c\pi t}{2l}+B_n\sin\frac{(2n-1)c\pi t}{2l}\right)\sin\frac{(2n-1)\pi x}{2l}$$at this point, we rewrite the initial conditions as $$u|_{t=0}=\sum_{n=1}^\infty A_n\sin\frac{(2n-1)\pi x}{2l}=x(x-2l),\quad u_t|_{t=0}=\sum_{n=1}^\infty\frac{(2n-1)c\pi}{2l}B_n\sin\frac{(2n-1)\pi x}{2l}=0$$from which we conclude that $$A_n=\frac{2}{l}\int_0^lx(x-2l)\sin\frac{(2n-1)\pi x}{2l}dx=-\frac{32l^3}{(2n-1)^3\pi^3},\quad B_n=0$$hence the final solution is $$u(x,t)=-\sum_{n=1}^\infty\frac{32l^3}{(2n-1)^3\pi^3}\cos\frac{(2n-1)c\pi t}{2l}\sin\frac{(2n-1)\pi x}{2l}$$
## SoV for heat equation on bounded domain
Consider the [[Heat Equation]] problem given by $$\begin{cases}u_t-\alpha\Delta u=0,&x\in[0,l],t\ge0\\u(x,0)=f(x),&x\in[0,l]\\u(0,t)=u(l,t)=0,&t\ge0\end{cases}$$We assume similarly as above that $u(x,t)=X(x)T(t)$, then we get $$\frac{T''}{\alpha T}=\frac{X''}{X}=-\lambda\quad\Longrightarrow\quad X(x)=B\sin\left(\sqrt\lambda x\right)+C\cos\left(\sqrt\lambda x\right),\quad T(t)=Ae^{-\lambda\alpha t}$$by substituting it into the IV and BV we can get the results. 