For $f:X\to Y$ where $(X,\Sigma_1),(Y,\Sigma_2)$ are measurable spaces is **$(\Sigma_1,\Sigma_2)$-measurable** if $$f^{-1}(E):=\{x\in X|f(x)\in E\}\subset \Sigma_1,\quad\forall E\in\Sigma_2$$That is, $\sigma(f)=f^{-1}(\Sigma_2)\subset\Sigma_1$ where $\sigma(f)$ is the $\sigma$-algebra generated by $f$ (the smallest $\sigma$-algebra on $X$ that makes $f$ measurable).
- **Composition of measurable functions**: for $f:(X,\Sigma_1)\to(Y,\Sigma_2),g:(Y,\Sigma_2)\to(Z,\Sigma_3)$ measurable, we have $g\circ f$ measurable. However this may not be true if $g$ is defined on some $\sigma$-algebra other than $\Sigma_2$.
- **Simple function**: $f:X\to\mathbb C$ is simple if $f$ is measurable and $\left|\im f\right|<\infty$, i.e., $$f=\sum_1^n z_j\chi_{E_j}\quad\text{where}\quad E_j=f^{-1}(\{z_j\}),\im f=\{z_1,\cdots,z_n\}$$We call this the **canonical representation** of $f$.
	- **Step function**: notice that simple functions only requires each $E_j$ to be measurable, not intervals. On the other hand, if each $E_j$ is an interval then we call it a step function.
- **Induced measure**: for $f:(X,M)\to(B,N)$ measurable where $(X,M,\mu)$ is a measure space, $f$ induces a measure on $N$ by $f_*\mu(E)=\mu(f^{-1}(E)),\forall E\in N$.
## Lebesgue measurable function
$f:(\mathbb R^d,\mathcal L)\to(\overline{\mathbb R},\mathcal B)$ is **Lebesgue measurable** if $\set{x\in X:f(x)\ge a}\in\mathcal L,\forall a\in\mathbb R$ (or $\le,>,<$).
**Why $\mathcal B$ for codomain**: several reasons are in order.
1. **Range of measurable functions**: we hope that most "good" functions are measurable, and It turns out that $\mathcal B$ is the simplest one to investigate. If we use $\mathcal L$ instead, many "good" functions will not be measurable, say most continuous functions.
2. **Requirement from integration theory**: developing an (sensible) integration theory requires the codomain to be a complete vector space (for good properties like linearity of simple function), and if we choose $\mathcal L$ a lot of pathologies will be introduced.
3. **Habit from probability theory**: the theory of measure and Lebesgue integration is largely motivated by probability theory, in which we're usually interested in objects that look like $P([a,b))=\int_{[a,b)}fd\mu$, so it's natural to think about $\sigma$-algebra generated by all cubes.
Note that in probability theory we more often consider $(\mathcal B,\mathcal B)$-measurable functions, for they're more useful in related theory.
- **Finite valued functions**: for $-\infty<f<\infty$ we only need to verify a specific kind of interval (excluding $\infty$). Given that $f^{-1}(\infty),f^{-1}(-\infty)$ measurable we can cover extended-valued functions.
- **Measurability rule**: measurability behaves quite well in practice, discussed as follows:
	- **Limit function**: given $\set{f_n}$ measurable, all $\sup f_n,\inf f_n,\limsup f_n,\liminf f_n$ are measurable.
	  **Proof**: $\set{\sup f_n>a}=\bigcup\set{f_n>a}$, and same for $\inf f_n$. For the other two just notice that $\limsup_n=\inf_k\sup_{n\ge k}$ and same for $\liminf$.
		- **Counterexample**: when the index set is not countable then these limits may not be measurable, say, let $I$ be a non-measurable set, and let $f_\alpha(x)=\delta_{\alpha x}$.
	- **Arithmetic operation**: given $f,g$ measurable and finite-valued, we have $f+g,fg$ measurable. When $f>0$ we also have $f^g$ measurable.
	- **Composition**: we only need to verify the domain and codomains.
- **Continuous function**: continuous function is **Borel measurable** by definition of continuity ([[Point Set Topology]]), but may not be Lebesgue measurable, e.g. the inverse of $\phi(x)=x+c(x)$ where $c(x)$ is the Cantor function. [[Special Function Gallery]]
	- **Composition**: for $f$ measurable and finite-valued, and $\Phi$ continuous we have $\Phi\circ f$ measurable, but it's not the case for $f\circ\Phi$, which is self-evident in the following line: $\mathcal B\subsetneq\mathcal L$. To illustrate in one line, we have $$f:\mathcal L_\mathbb R\to\mathcal B_\mathbb R,\quad\Phi:\mathcal B_\mathbb R\to\mathcal B_\mathbb R\quad\Longrightarrow\quad f\circ\Phi:\mathcal B_\mathbb R\to\mathcal L_\mathbb R$$For explicit example, take $\Phi:\mathcal C_1\to\mathcal C_2$ two Cantor-like sets with $\lambda(\mathcal C_1)>0,\lambda(\mathcal C_2)=0$ ([[Special Function Gallery]]), and let $f=\chi_{\Phi(N)}$ for some non-measurable $N\subset\mathcal C_1$. In this case $f\circ\Phi=\chi_N$, which is obviously non-measurable.
- **Approximation by simple function**: given any $f$ measurable there exists a increasing series of simple functions (in absolute value) that approximate $f$ pointwise.
	- **Non-negative function**: consider a cube $Q_N$ centered at origin with side length $N$, and denote $F_N=\chi_{Q_N}\max(f(x),N)$, then $F_N\to f$ as $N\to\infty$. For fixed $N$ we take a large $M$ and let $E_{k,M}=\set{x\in Q_N:\frac{k}{M}<F_N(x)\le\frac{k+1}{M}}$, and define $$F_{N,M}=\sum_k\frac{k}{M}\chi_{E_{k,M}}(x)$$then each $F_{N,M}$ is a simple function with $0\le F_N(x)-F_{N,M}(x)<1/M,\forall x$. Let $M,N\to\infty$ would yields a desired simple function sequence.
	- **Arbitrary function**: take $f^+=\max(f,0),f^-=\max(-f,0)$ and apply the above result to each of them. Adding the resulting simple functions together complete the proof.
	- **Approximation by step function**: pointwise convergence for all $x\in\mathbb R^d$ is weakened to $\ae$ for step function.
	  **Proof**: it suffices to consider $\chi_E$ for measurable $E$. By regularity we can find a finite set of cubes $\set{Q_k}$ with $|E\triangle\bigcup Q_j|<\varepsilon$ ([[Lebesgue Measure]]), hence the desired sequence of step functions can be found.
## Littlewood's three principles
Littlewood summarized three connections between measurable sets/ functions and those we're already familiar with, listed below:
1. Every set is nearly a finite union of intervals.
2. Every function is nearly continuous
3. Every convergent sequence is nearly uniformly convergent.
The first principle is in [[Lebesgue Measure]], and the following are the formalization of the last two.
- **Egorov's theorem**: given $\lambda(E)<\infty$ and $\set{f_k}\to f\ a.e.$, for any $\delta>0$ there exists $E_\delta\subset E$ with $\lambda(E_\delta)<\delta$ s.t. the convergence is uniform on $E\backslash E_\delta$.
  **Proof**: choose $\varepsilon=1/n$ in the bound below with geometrically decreasing measure, and take their union. The complement is what we want. One more intuitive way of seeing this is that existence of some $E_\delta$ on which $|f_n-f|>\varepsilon$ contradicts $\ae$ convergence itself.
	- **Bounding divergent domain**: for any $\varepsilon>0$ let $E_n(\varepsilon)=\set{x\in E:|f_n-f|\ge\varepsilon}$, then $$\lambda\left(\bigcap_{k\in\mathbb N}\bigcup_{n=k}^\infty E_n(\varepsilon)\right)=0\quad\Longrightarrow\quad\lim_{k\to\infty}\lambda\left(\bigcup_{n=k}^\infty E_n(\varepsilon)\right)=0$$by continuity of [[Lebesgue Measure]].
- **Lusin's theorem**: for $f$ measurable and essentially bounded on $E\subset\mathbb R^d$ with $\lambda(E)<\infty$, given any $\delta>0$ there exists closed $F\subset E,\lambda(E\backslash F)<\delta$ s.t. $f$ is continuous on $F$.
  **Proof**: take $f_n\to f\ae$ a sequence of simple functions, then the convergence is uniform by Egorov's theorem on $E_\delta$, while each $f_n$ is continuous except for a set of measure $\delta/2^n$. The desired closed set can be easily constructed.  
	- **Corollary**: for $f$ measurable and essentially bounded, there exists a sequence of continuous functions $\set{f_n}$ s.t. $f_n\to f\ a.e.$.
	- **Inverse**: a essentially bounded function that is continuous beyond an arbitrarily small subset is measurable. 
	  **Proof**: by taking descending sequence we know that $f$ is continuous, thus measurable on a subset whose complement is of (outer) measure $0$, hence it's measurable.
	- **Remark**: although the precision can be made arbitrarily small, the conclusion fails for $\delta=0$, say we can take $\chi_{[0,\frac{1}{2}]\backslash\mathbb Q}-\chi_{[\frac{1}{2},1]\backslash\mathbb Q}$.
## Convergence of measurable functions
- **Almost everywhere convergence**: we define $$f_n\xto\ae f \quad\iff\quad\mu\left(\set{x:f_n(x)\not\to f(x)}\right)=0$$
	- **Useful lemma**: denote $D_{n,\epsilon}=\set{|f_n-f|>\varepsilon}$, then $$\sum_{n\in\mathbb N}\mu(D_{n,\varepsilon})<\infty,\quad\forall\varepsilon>0\quad\Longrightarrow\quad f_n\xto\ae f$$This is a simple consequence of Borel-Cantelli lemma ([[Lebesgue Measure]]), utilizing the set theoretic results below. Note that the converse is not valid, e.g., $f_n=1-\chi_{[-n,n]}$.
	- **Topological perspective**: $\ae$ convergence is not induced by any topology, since otherwise we can pick $f_n$ satisfying $f_n\xto\mu0,f_n\not\xto\ae0$, and by definition there exists a neighborhood $U(0)$ s.t. $f_n$ is frequently outside $U(0)$, however the subsequence outside $U(0)$ has further a sub-subsequence that converges $\ae$ to $0$ ([[Subsequence Acceleration]]), which is a contradiction.
Below we list some useful [[Set Theory]] results about measurable functions.
- **Structure of continuity**: for $f$ defined on open $G\subset\mathbb R^d$, set of continuities of $f$ is $G_\delta$ set. 
  **Proof**: denote $\omega_f(x)$ the oscillation of $f$ at $x$ ([[Function on Euclidean Space]]), then since $f$ is continuous at $x$ iff $\omega_f(x)=0$, the set of continuities can be expressed as $$\bigcap_{k=1}^\infty\Set{x\in G:\omega_f(x)<\frac{1}{k}}$$each of the above sets is open ([[Point Set Topology]]), completing the proof.
- **Structure of continuity of limit function**: let $f_k\in C(\mathbb R^d),\lim f_k=f$, then the continuity set of $f$ is $$\bigcap_{m=1}^\infty\bigcup_{k=1}^\infty\operatorname{int}E_k\left(\frac{1}{m}\right)\quad\text{where}\quad E_k(\varepsilon)=\set{x\in\mathbb R^d:|f_k(x)-f(x)|\le\varepsilon}$$which is also a $G_\delta$ set. This can be shown by the $3\varepsilon$ method.
	- **Baire function**: Baire class $0$ function refers to continuous functions, and the Baire class $\alpha$ functions are all functions which are the pointwise limit of a sequence of functions of Baire class less than $\alpha$.
- **Expression of convergent point**: let $\set{f_n}$ be a sequence of continuous functions on closed $F\subset\mathbb R^d$, then by Cauchy property ([[Metric Space]]) the set of its convergence point is $$\begin{align}C&=\bigcap_{k=1}^\infty\Set{x\in\mathbb R^d:\exists N\subset\mathbb N \text{ s.t. }m,n>N\Rightarrow\left|f_m(x)-f_n(x)\right|\le\frac{1}{k}}\\&=\bigcap_{k=1}^\infty\bigcup_{n=1}^\infty\Set{x\in\mathbb R^d:\left|f_m(x)-f_n(x)\right|\le\frac{1}{k},\forall m\ge n}\\&=\bigcap_{k=1}^\infty\bigcup_{n=1}^\infty\bigcap_{t\ge n}\Set{x\in\mathbb R^d:\left|f_t(x)-f_n(x)\right|\le\frac{1}{k}}\end{align}$$which is a $F_{\sigma\delta}$ set. If a limit $f$ is defined then the set of convergent point is $$C_f=\bigcap_{k=1}^\infty\bigcup_{n=1}^\infty\bigcap_{t\ge n}\Set{x\in\mathbb R^d:\left|f_t(x)-f(x)\right|\le\frac{1}{k}}$$whose proof is essentially the same, relying on definition of convergence. 
	- **Converse**: the converse is also true, that is, given any $F_{\sigma\delta}$ set $C$ there exists a sequence of continuous functions $f_n$ that converges exactly on $C$. This was first proved by Hahn in 1919, as discussed in the [MSE post](https://math.stackexchange.com/questions/2134630/)
- **Expression of divergent point**: similarly the set of divergent point can be expressed as $$D=\bigcup_{k=1}^\infty\bigcap_{n=1}^\infty\bigcup_{t\ge n}\Set{x\in\mathbb R^d:\left|f_t(x)-f_n(x)\right|>\frac{1}{k}}$$and when for a target limit $f$ the above can be turned into $$D_f=\bigcup_{k=1}^\infty\bigcap_{n=1}^\infty\bigcup_{t\ge n}\Set{x\in\mathbb R^d:\left|f_t(x)-f(x)\right|>\frac{1}{k}}$$The proofs are similar, or alternatively we can also proceed by taking complement of the results above, utilizing De Morgan's law. [[Set Theory]]
## Convergence in measure
A notion of convergence that rises naturally from Egorov's theorem is **convergence in measure**: $$f_n\xto{\mu}f\quad\iff\quad\mu(\set{x:|f_k-f|>\varepsilon})\to0,\quad k\to\infty,\forall \varepsilon>0$$This rise naturally in the above proof, and is equivalent to **Cauchy in measure**: $$\mu(\set{x:|f_k-f_l|>\varepsilon})\to0\quad\text{as }k,l\to\infty$$The proof is similar to that of [[Series]].
We care about convergence in measure for several reasons, including its broader description of sequence (focusing on bounding size of domain of divergence rather than its precise position), pervasive application in probability theory, and robustness under limit and integral.
- **Well-defined-ness**: given $f_n\xto{\mu} f,f_n\xto{\mu} g$ we have $f=g\ \ae$, otherwise $\mu(\set{f\neq g})=\delta>0$, since we can choose some subset $\mu(E)=\delta/2$ s.t. $|f-g|>\varepsilon$, measure convergence applied to $\varepsilon'=\varepsilon/3$ and $\delta/8$ yields a contradiction.
- **Relation with $\ae$ convergence**: on $\mu(E)<\infty$ $\ae$ convergence is stronger by boundedness of divergent domain above, illustrated by a simple example $$f_n=\chi_{E_n}\quad\text{where}\quad E_n=[H_n,H_{n+1}]/\mathbb Z,H_n=\sum_{k=1}^n\frac{1}{k}$$Intuitively domain of convergence is itself prescribed by $\ae$ convergences, while in measure convergence only the measure of domain of convergence is restricted, leaving space for bad behavior like uniformly distributed oscillation. Note that for $\mu(E)=\infty$ the case is a bit tricker, e.g., $f_n(x)=x/n$ satisfies $f_n\xto{\ae}0,f_n\not\xto{\mu}0$.
	- **Riesz theorem**: sequence of measurable functions that converges in measure has a sub-sequence that converges $\ae$, since we can pick $$\lambda(E_k)=\lambda(\set{|f_{n_k}-f|>2^{-k}})<2^{-k},\quad\forall k\in\mathbb N$$take $S=\limsup E_k$, then by Borel-Cantelli ([[Lebesgue Measure]]) $\lambda(S)=0$, and on $E\backslash S$ we have $f_{n_1}+\sum|f_{n_{k}}-f_{n_{k-1}}|<\infty$, hence the sequence converges. 
	- **Partial converse**: on set of finite measure if any sub-sequence has in turn a sub-sub-sequence converging to $f\ae$ then  $f_n\xto\lambda f$. We can first pick the $\ae$ limit of one subsequence and then show that other sub-sequences also converges to it in measure by contradiction. Actually the condition can be weakened, as in the lemma below.
- **Sub-sequence principle**: $f_n\xto\mu f$ iff any sub-sequence has a sub-sub-sequence converging to $f$ in measure, since measure convergence is induced by the metric $$d(f,g)=\inf_{\delta>0}(\mu(\set{|f-g|>\delta})+\delta)$$Another way of seeing this indirectly is that $\mathcal L$ with measure convergence is a first countable topological vector space, which is metrizable. [[Metric Topology]]
	- **Verification of topological convergence**: from this principle we also know that $\ae$ convergence is not induced by any topology, since "any sub-sequence has a sub-sub-sequence that converges $\ae$" does not imply $\ae$ convergence, say $$f_n=\chi_{E_n}\quad\text{where}\quad E_n=\left[\frac{i}{2^k},\frac{i+1}{2^k}\right],n=2^k+i,0\le i<2^k$$Obviously this sequence does not converges $\ae$ but satisfies the first assertion by [[Diagonal Argument]].
- **Arithmetic operation**: given $f_n\xto{\mu}f,g_n\xto\mu g$ we have $f_n+g_n\xto\mu f+g$ by estimating measure of divergent domain, and on a set of finite measure we have $f_ng_n\xto\mu fg$, which follows directly form sub-sequence principle.