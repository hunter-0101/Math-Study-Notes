**Motivation**: in [[Eigendecomposition]] we've observed that unitary matrices can be diagonalized via eigenvectors. This idea is generalized to bounded linear [[Operator]] that preserves its key idea.

---
## Spectral theorem for compact self-adjoint operator
- **Spectrum of compact self-adjoint operator**: for $T$ compact self-adjoint on separable $\mathcal H$ we have the following results concerning its spectrum [[Operator]]:
	- **Eigenvalues**: all eigenvalues are real, by conjugate symmetry of inner product, and eigenvalues are at most countable by the following result.
	- **Eigenvectors**: eigenvectors of different eigenvalues are orthogonal, and $\dim\ker(T-\lambda I)$ is finite. Moreover, $\dim\bigoplus_{|\lambda|>\mu}\ker(T-\lambda I)$ is finite for any $\mu>0$, otherwise contradicting compactness. 
	- Either $\|T\|$ or $-\|T\|$ is an eigenvalue of $T$. This is where we utilize compactness.
	  **Proof**: notice that either $\|T\|=\sup_{\|u\|=1}\braket{Tu,u}$ or $-\|T\|=\inf_{\|u\|=1}\braket{Tu,u}$, assuming the first case we pick $\set{u_n}$ s.t. $\braket{Tu_n,u_n}\to\|T\|$, then by compactness we have $\lim Tu_n\to v$ (pick a sub-sequence if necessary). It's easy to verify that $\|Tu_n-\|T\|u_n\|\to0$, hence $\|T\|u_n\to v$, and by continuity we have $Tv=\|T\|v$. The other case is similar.
- **Spectral theorem**: for self-adjoint $T\in\mathcal K$ on separable $\mathcal H$ there exists an orthonormal basis $\set{\varphi_n}$ consisting of eigenvectors of $T$. Moreover if $T\varphi_n=\lambda_n\varphi_n$ then $\lambda_n\to0$. Conversely, every operator satisfying the above conditions is compact and self-adjoint.
  **Proof**: denote $S$ the closure of subspace spanned by eigenvectors of $T$. $S$ is not empty since it contains at least one of $\|T\|,-\|T\|$, and denoting $\mathcal H=S\oplus S^\perp$, it suffices to show $S^\perp=\varnothing$. Notice that $TS^\perp\subset S^\perp$, it's easy to verify that $T_1=T|_{S^\perp}$ is also a self-adjoint compact operator. If $S^\perp\neq\varnothing$ the above lemma shows that $T_1$ has at least one eigenvector in $S^\perp$, which by definition is in $S$, yielding a contradiction.
	- **Intuition**: we're basically utilizing the fact that self-adjoint compact operator has at least one eigenvector in any Hilbert space, and removing eigen-subspace from the space would still yields an invariant subspace. This is similar to the results in [[Eigendecomposition]] in linear algebra.
	- **Simultaneous diagonalization**: for compact self-adjoint $T_1,T_2\in\mathcal L(\mathcal H)$, they share a same set of eigenvectors iff $T_1T_2=T_2T_1$.
	  **Proof**: $\Rightarrow$ is obvious; for $\Leftarrow$ notice that for $T_1v=\lambda v$ we have $T_1(T_2v)=T_2T_1v=\lambda(T_2v)$, hence any eigenspace of $T_1$ is $T_2$-invariant. The rest is similar to the proof of spectral theorem.
		- **Normal operator can be diagonalized**: any compact $T$ s.t. $TT^*=T^*T$ can be diagonalized, since we can decompose $T=\frac{1}{2}(T+T^*)+\frac{1}{2}(T-T^*)$ and diagonalize each simultaneously. 
		- If $U$ is unitary and $U=\lambda I-T$ where $T$ is compact, then $U$ can be diagonalized. We only need to verify that $T$ is normal and apply the above.
- **SVD of compact operator**: for $T\in\mathcal K(\mathcal H)$ we have $T^*T$ compact and self-adjoint, hence $$T^*Tu=\sum_n\lambda_n\braket{u,e_n}e_n\quad\text{where}\quad T^*Te_n=\lambda_ne_n$$Denote $f_n'=Te_n$, then $$\braket{f_i',f_j'}=\braket{Te_i,Te_j}=\braket{T^*Te_i,e_j}=\lambda_i\delta_i^j$$hence $\set{f_n'}$ forms an orthogonal set with $\|f_n'\|=\sqrt{\lambda_n}$. Normalize $\set{f_n'}$ to $\set{f_n}$, then $$T:u\mapsto\sum_{n}\sigma_n\braket{u,e_n}f_n\quad\text{where}\quad\sigma_n=\sqrt{\lambda_n}$$This is exactly the same form as [[Singular Value Decomposition]].
## Spectral theorem for symmetric operator
A **spectral resolution** is a function $\lambda\mapsto E(\lambda)$ from $\mathbb R$ to orthogonal projections on $\mathcal H$ satisfying:
1. $E(\lambda)$ is increasing in the sense that $\|E(\lambda)f\|$ is increasing w.r.t $\lambda$ for every $f\in\mathcal H$.
2. There exists an interval $[a,b]$ s.t. $E(\lambda)=0,\forall \lambda<a$ and $E(\lambda)=I,\forall\lambda\ge b$.
3. $E(\lambda)$ is right continuous in the sense that $E(\mu)f\to E(\lambda)f$ as $\mu\searrow\lambda$.
Notice that given $\lambda<\mu$ we have $$1\iff\im E(\lambda)\subset\im E(\mu)\iff E(\mu) E(\lambda)=E(\lambda)\iff E(\mu)-E(\lambda)\text{ is an orthogonal projection}$$Denote $F(\lambda)=\braket{E(\lambda)f,g}$ given $f,g$, then since $\lambda\mapsto\|E(\lambda)f\|^2$ is also increasing by polarization identity ([[Hilbert Space]]) we have $F(\lambda)\in BV$ and is right continuous.
- **Positive operator**: symmetric $T$ is said to be positive, written as $T\ge0$, if $\braket{Tf,f}\ge0,\forall f\in\mathcal H$. We write $T_1\ge T_2$ If $T_1-T_2\ge0$. Below we denote $a=\min\braket{Tf,f},b=\max\braket{Tf,f},\|f\|=1$.
	- **Boundedness**: for $T$ symmetric, $\|T\|\le M\iff -MI\le T\le MI$, hence $\|T\|=\max(|a|,|b|)$. This follows directly from property of symmetric [[Operator]].
	- **Square root**: for $T\ge0$ there exists symmetric $S$ s.t. $S^2=T$ and $S$ commutes with any operator that commutes with $T$. We denote $S=T^{1/2}$.
	  **Proof**: by [[Differential Calculus on Euclidean Space]] we have $(1-t)^{1/2}=\sum(-1)^n\binom{1/2}{n}t^n,|t|\le1$. By multiplying a constant we may assume that $\|T\|\le1$, hence we can define $$S=\sum_{n\in\mathbb N}(-1)^n\binom{1/2}{n}(I-T)^n$$The convergence is guaranteed by absolute convergence of expansion of $(1-t)^{1/2}$, and we can also verify that $\|S_n^2-T\|\to0$. Hence we get $S^2=T$. Any $A$ that commutes with $T$ also commutes with all its polynomials, hence $AS_n=S_nA$, hence $AS=SA$.
	- For $T_1,T_2\ge0,T_1T_2=T_2T_1$ we have $T_1T_2\ge0$.
	- **Polynomial of positive operator**: for $T\ge0$ with $a,b$ given above, and $p(t)=\sum_{k=0}^na_kt^k$ which is positive on $(a,b)$, the operator $p(T)$ is also positive. This can be shown by decomposing $p(t)$ into irreducible factors on $\mathbb R$ and use the last result.
		- $\|p(T)\|\le\sup_{[a,b]}|p(t)|$ by boundedness property.
	- **Decreasing sequence**: for $T_n\ge0$ with $T_n\ge T_{n+1}$ there exists $T$ s.t. $T_nf\to Tf,\forall f\in\mathcal H$.
	  **Proof**: for $S\ge0,\|S\|\le M$ consider the quadratic form $\braket{S(tI+S)f,(tI+S)f}$. By expansion it's positive for all $t$, hence its discriminant is negative, yielding $$\|Sf\|^4\le\braket{Sf,f}^{1/2}M^{3/2}\|f\|$$Apply this to $S=T_n-T_m,n\le m$ we get $\|T_n-T_m\|\le M$ (this can also be deduced directly). On the other hand we also have $\braket{(T_n-T_m)f,f}\to0,\forall f$ by Cauchy property, hence $\|T_nf-T_mf\|\to0$, hence $\lim T_nf=Tf$ exists, and $T$ is obviously positive.
- **Spectral theorem**: for $T$ bounded symmetric there exists a spectral resolution $E(\lambda)$ s.t. $$T=\int_{a^-}^b\lambda dE(\lambda)$$under the Lebesgue-[[Stieltjes Integral]] framework, in the sense that $$\braket{Tf,g}=\int_{a^-}^b\lambda d\braket{E(\lambda)f,g}=\int_{a^-}^b\lambda dF(\lambda)$$**Proof**: any polynomial $\Phi$ on $[a,b]$ can be associated with a positive operator $\Phi(T)$, which is a homomorphism. By Weierstrass theorem ([[Functional Approximation]]) we generalize to $C([a,b])$, and finally to any function that arises as the limit of a decreasing sequence of positive continuous functions. Notice that $\Phi_1\le\Phi_2,\forall t\in[a,b]\Rightarrow\Phi_1(T)\le\Phi_2(T)$. Now we define $$\phi_\lambda(t)=\begin{cases}1,&t\le\lambda\\0,&t>\lambda\end{cases},\qquad E(\lambda)=\phi_\lambda(T)$$It can be verified directly that $E(\lambda)$ is a spectral resolution. For the spectral representation, take $a=\lambda_0<\cdots<\lambda_k=b$ with $\sup(\lambda_j-\lambda_{j-1})<\delta$, then since $$t\le\sum_{j=1}^k\lambda_j(\phi_{\lambda_j}(t)-\phi_{\lambda_{j-1}}(t))+\lambda_0\phi_{\lambda_0}(t)\le t+\delta,\quad\forall t\in[a,b]$$Apply the inequality to $T$ we know that $T$ differs from the sum in norm by at most $\delta$. Hence $$\left|\braket{Tf,f}-\left(\sum_{j=1}^k\lambda_j\int_{(\lambda_{j-1},\lambda_k]}d\braket{E(\lambda)f,f}+\lambda_0\braket{E(\lambda_0)f,f}\right)\right|\le\delta\|f\|^2$$Letting $\delta\to0$ produces the desired integral, and polarization identity further yields the cases for $g\neq f$. 
	- **General case**: with similar argument we can further show that for $\Phi\in C([a,b])$ we have $$\braket{\Phi(T)f,g}=\int_{a^-}^b\Phi(\lambda)d\braket{E(\lambda)f,g}$$We only need to replace $t$ with $\Phi(t)$ and utilize uniform continuity of $\Phi$.