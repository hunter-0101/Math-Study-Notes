A **smooth ($C^\infty$) manifold** is a [[Topological Manifold]] $M$ together with a maximal $C^\infty$ atlas $\mathfrak A$. Here $\mathfrak A$ is also called a **smooth structure** on $M$. 
- **Motivation**: maximal atlas always exists, but it's just a matter of convenience for definition. At the end we do not care about maximality of atlas, but rather the geometric and topological properties of the manifold itself. Note that this definition is not even suitable for proving or disproving a topological space to be a smooth manifold.
## Smooth functions on smooth manifold
$f:M\to\mathbb R$ is said to be smooth if $$\begin{align}f\in C^\infty(M)\quad&\iff\quad\forall p\in M,\exists(U_p,\phi) \text{ s.t. } f\circ\phi^{-1}\in C^\infty(\phi(U))\\&\iff\quad f\circ\phi^{-1}\in C^\infty,\forall(U,\phi)\in\mathfrak A\\&\iff\quad f\circ\phi^{-1}\in C^\infty,\forall p\in(U,\phi)\text{ on }M\end{align}$$The equivalence follows from **independence of chart** in definition, due to compatibility of charts within the same atlas
- **Smooth maps between manifold**: consider manifolds $M,N$ or dimensions $m,n$. Continuous $F:M\to N$ is said to be smooth if $$F\in C^\infty(M,N)\quad\iff\quad\forall p\in M,\exists(U_p,\phi),(V_{F(p)},\psi)\text{ s.t. }\psi\circ F\circ\phi^{-1}\in C^\infty(\mathbb R^m,\mathbb R^n)$$which is obviously also independent of charts, hence similarly we also only need to check all pairs of charts in $\mathfrak{A}\times\mathfrak{B}$ for $M,N$ or all pairs of charts.
	- **Transitivity**: $F\in C^\infty(M,N),G\in C^\infty(N,P)\Rightarrow G\circ F\in C^\infty(M,P)$ by compatibility.
	- **Smoothness of vector-valued function**: given $f:M\to\mathbb R^d$, then $f\in C^\infty$ iff each of its components is smooth, which follows from definition of smoothness in [[Differential Calculus on Euclidean Space]], by viewing $\mathbb R^d$ as a manifold with a single chart $(\mathbb R^d,\mathbb1)$.
	- **Smoothness of a map in terms of vector-valued function:** for $F:M\to N$ we have $F\in C^\infty(M,N)$ iff $N$ has an atlas $\mathfrak B=\set{(V,\psi)=(V,y^1,\cdots,y^n)}$ s.t. $\psi\circ F\in C^\infty(M,\mathbb R^n)$.
	  **Proof**: $\Rightarrow$ is obvious  since $\psi\in C^\infty$ as a coordinate map, and for $\Leftarrow$ consider 
	  <p align="center"><img align="center" src="https://i.upmath.me/svg/%0A%5Cbegin%7Btikzcd%7D%0AM%20%5Carrow%5Bd%2C%20%22%5Cphi%22'%5D%20%5Carrow%5Br%2C%20%22F%22%5D%20%5Carrow%5Brd%2C%20%22%5Cpsi%5Ccirc%20F%22%5D%20%26%20N%20%5Carrow%5Bd%2C%20%22%5Cpsi%22%5D%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%5C%0A%5Cmathbb%20R%5Em%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%26%20%5Cmathbb%20R%5En%20%5Carrow%5Br%2C%20%22%5Ctext%7Bid%7D%22%5D%20%26%20%5Cmathbb%20R%5En%0A%5Cend%7Btikzcd%7D%0A" /></p>
	  now $\psi\circ F\in C^\infty(M,\mathbb R^n)$ implies $\psi\circ F\circ\phi^{-1}\in C^\infty(\mathbb R^m,\mathbb R^n)$, which means $F\in C^\infty$.
		- By similar reasoning we further establish its equivalence with $y^i\circ F\in C^\infty,\forall i$. 
- **Diffeomorphism**: a bijective $F\in C^\infty(M,N)$ is a diffeomorphism if $F^{-1}\in C^\infty$. We have that $F:U\to\mathbb R^m$ is a diffeomorphism iff $(U,F)$ is a chart in the differentiable structure of $M$.
  **Proof**: for $\Leftarrow$ we view $\mathbb R^m$ as a manifold with one single chart $(\mathbb R^m,\mathbb{1})$, then for any chart $(U,\phi)$ of $M$ we have $\mathbb 1\circ\phi\circ\phi^{-1}=\mathbb 1\in C^\infty$, hence $\phi\in C^\infty(M,\mathbb R^m)$, and similarly we get $\phi^{-1}\in C^\infty$. For $\Rightarrow$ given $(U_\alpha,\phi_\alpha)\in\mathfrak A$ we have $\phi_\alpha,\phi_\alpha^{-1}\in C^\infty$ by definition, hence $F\circ\phi_\alpha^{-1},\phi_\alpha\circ F^{-1}\in C^\infty$, which means $(U,F)$ is compatible with $(U_\alpha,\phi_\alpha)$, then by maximality we have $(U,F)\in\mathfrak A$.
	- **Identification of manifold structures**: two manifold structures, i.e., a topological space with two different (non-maximal) atlases are considered the same if there exists a diffeomorphism between them. For example, given linear space $\dim V<\infty$ the automorphism group $\gl(V)$ ([[Group Gallery]]) could be endowed with $$\phi_e:\gl(V)\to\gl(n,\mathbb R),\quad\left(e_i\mapsto\sum_ia_j^ie_i\right)\mapsto[a_j^i]$$if we denote this group as $\gl(V)_e$, and choose another basis $u=(u^i)$ to get $\gl(V)_u$, then the basis transform matrix $u=Ae$ is a diffeomorphism between two structures, hence $\gl(V)_e,\gl(V)_u$ are regarded the same.
	- **Group of diffeomorphism**: the collection of diffeomorphisms on $M$ forms a group under composition, which is denoted $\diff(M)$.
## Partial derivative
Denote $r^i$ the standard coordinate in $\mathbb R^m$, and $x^i$ the local coordinate system for $M$, i.e., components of $\phi$, then $x^i=r^i\circ\phi$. For $f\in C^\infty(M)$ we define the **partial derivative** at $p$ as $$\left.\frac{\partial}{\partial x^i}\right|_pf=\frac{\partial(f\circ\phi^{-1})}{\partial r^i}(\phi(p))=\left.\frac{\partial}{\partial r^i}\right|_{\phi(p)}(f\circ\phi^{-1})$$Notice that we can write $$\frac{\partial f}{\partial x^i}(\phi^{-1}(\phi(p)))=\frac{\partial (f\circ\phi^{-1})}{\partial r^i}(\phi(p))\quad\Longrightarrow\quad\frac{\partial f}{\partial x^i}\circ\phi^{-1}=\frac{\partial (f\circ\phi^{-1})}{\partial r^i}$$hence $\partial f/\partial x^i$ is $C^\infty$ since its pullback $(\partial f/\partial x^i)\circ\phi^{-1}$ is $C^\infty$ on $\phi(U)$. Below we'll simply denote the partial derivative as $\partial_if$.
- **Duality**: we have $\partial_i x^j=\delta_i^j$ by definition.
- **Jacobian**: For $F:M\to N$ with $(U,\phi)=(U,x^1,\cdots,x^m),(V,\psi)=(V,y^1,\cdots,y^n)$ s.t. $F(U)\subset V$, denote $F^i=y^i\circ F=r^i\circ\psi\circ F$ the $i$-th component of $F$ in $(V,\psi)$, then define $$J_F=[\partial_j F^i]$$as the **Jacobian matrix** of $F$ relative to $(U,\phi),(V,\psi)$. 
- **Inverse function theorem**: for $F\in C^\infty(M,N)$ with $m=n$, set $F^i=y^i\circ F$, then $F$ is a local diffeomorphism iff $\det J_F\neq0$.
  **Proof**: notice that by definition $$\partial_j F^i(p)=\frac{\partial(r^i\circ\psi\circ F)}{\partial x^j}(p)=\frac{\partial(r^i\circ\psi\circ F\circ\phi^{-1})}{\partial r^j}(\phi(p))$$which is the Jacobian of $$\psi\circ F\circ\phi^{-1}:\mathbb R^n\supset\phi(U)\to\psi(V)\subset\mathbb R^n$$hence by inverse function theorem in [[Differential Calculus on Euclidean Space]], $\det J_F\neq0$ iff $\psi\circ F\circ\phi^{-1}$ is locally invertible at $\phi(p)$, and since both $\phi,\psi$ are diffeomorphisms this is further equivalent to $F$ being a local diffeomorphism.
	- **Corollary**: since coordinate chart is equivalent to a local diffeomorphism, we know that $F^i$ defined on a coordinate neighborhood $(U,x^i)$ forms a local coordinate system iff $\det J_F\neq0$.
## Submanifold
Given manifold $M$ with dimension $m$ a subset $S\subset M$ is a **regular submanifold** of dimension $k$ if for each $p\in S$ there exists **adapted chart** $(U,\phi)=(U,x^i)\ni p$ of $M$ s.t. $U\cap S$ is defined via vanishing of $m-k$ coordinates . Notice that existence of adapted chart at each point makes $S$ also a manifold.
- **Choice of coordinates**: as discussed in [[Topological Manifold]], there is no canonical choice of coordinate in each chart across $\mathfrak A$. Hence we can assume the vanishing coordinates to be $x^{k+1},\cdots,x^m$ by reordering.
- **Level set**: given $F:M\to N$ the level set of $c$ is $F^{-1}(c)$. It's said to be a regular level set if $c$ is a regular value ([[Differential Calculus on Smooth Manifold]]). $Z(F)=F^{-1}(0)$ is called the **zero set**.
	- **Regular level set theorem**: for $F\in C^\infty(M,N)$ any non-empty regular level set $F^{-1}(c)$ is a regular submanifold of dimension $m-n$.
	  **Proof**: choose $(V,\psi)=(V,y^j)$ a chart centered at $c$, then $F^{-1}(c)=(\psi\circ F)^{-1}(0)$. By regularity and non-emptiness of level set we have $n\ge m$. Now pick any $p\in F^{-1}(c)$, and a coordinate neighborhood $(U,\phi)=(U,x^i)$ with $U\subset F^{-1}(V)$, then $\rank J_F=m$, hence we can assume by re-numbering that $[\partial F^j/\partial x^i]_{m\times m}$ is non-singular. Notice that $$(U,\phi')=(U,F^1,\cdots,F^n,x^{n+1},\cdots,x^m),\quad\det J_{\phi'}=\det\begin{bmatrix}\frac{\partial F^j}{\partial x_i}&*\\0&I\end{bmatrix}\neq0$$by inverse function theorem $\phi'$ is a diffeomorphism, hence a coordinate system. Now in the adapted chart $(U,\phi')$ the set $S=F^{-1}(c)$ is obtained by setting $F^j=0$, so $S$ is a submanifold by definition.
		- **Intuition**: regularity of $c$ ensures that $F$ behaves quite well in $(V,\psi)\ni c$, hence the pre-image of $c$ is naturally defined via vanishing of coordinates that are mapped to $(V,\psi)$.
		- **Only sufficiency**: the theorem only provide a sufficient condition for a level set to the a regular submanifold, not necessary, e.g. $f:\mathbb R^2\to\mathbb R$ by $f(x,y)=y^2$.
		- **Graph of smooth function**: for $F\in C^\infty(\mathbb R^m,\mathbb R^n)$ its graph $\Gamma(F)=(x,f(x))\subset\mathbb R^{m+n}$ is a submanifold since we can consider $G(x,y)=y-f(x)$, then $\Gamma(F)=G^{-1}(0)$.
- **Transversality theorem**: $F\in C^\infty(M,N)$ is transversal to submanifold $S\subset N$ if $$F_*(T_pM)+T_{F(p)}S=T_{F(p)}N,\quad\forall p\in F^{-1}(S)$$Given $F$ transversal when $S$ is a regular submanifold of codimension $k$ in $N$ then $F^{-1}(S)$ is a regular submanifold of codimension $k$ in $N$.
  **Proof**: for $p\in F^{-1}(S)$ consider the adapted chart $(V,y^1,\cdots,y^n)$ of $N$ w.r.t $S$. Assume that $V\cap S=Z(y^{n-k+1},\cdots,y^n)$, and define $$G: V\to\mathbb R^k,\quad G=(y^{n-k+1},\cdots,y^n)$$then $F^{-1}(V)\cap F^{-1}(S)=F^{-1}(V\cap S)=(G\circ F)^{-1}(0)$, Meanwhile, transversality implies $$\partial_{y^j}\in F_*(T_pM),\quad\forall n-k+1\le j\le n$$hence by chain rule $(G\circ F)_*=G_*\circ F_*$ we have $(G\circ F)_*$ surjective, showing $0$ a regular value. The desired result follows from the regular level set theorem.
	- **Intuition**: when $S=c$ a single point we have $k=n$, and the transversality theorem degenerates to the regular level set theorem. Intuitively transversing a point means covering the entire coordinate system near $F(p)$, which is equivalent to covering the entire tangent space.
- **Constant rank theorem**: given $F\in C^\infty(M,N)$, if $\rank F=k$ ([[Differential Calculus on Smooth Manifold]]) in a neighborhood of $p\in M$, then there exists $(U,\phi)$ centered at $p$ and $(V,\psi)$ centered at $F(p)$ s.t. $$(\psi\circ F\circ\phi^{-1})(r^1,\cdots,r^m)=(r^1,\cdots,r^k,0,\cdots,0)$$**Proof**: choose charts $(U,\overline\phi),(V,\overline\psi)$ centered at $p,F(p)$, then we have $\rank(\psi\circ F\circ\phi^{-1})=k$. Now it suffices to prove the theorem for $M=\mathbb R^m,N=\mathbb R^n$, which is obvious via Gaussian elimination ([[Solving Linear System]]) or [[Singular Value Decomposition]] of the Jacobian. When proper $G,H$ is chosen we can take $\phi=G\circ\overline\phi,\psi=H\circ\overline\psi$.
	- **Constant rank level set theorem**: in the above settings if $\rank F=k$ in a neighborhood of $F^{-1}(c)$ then $F^{-1}(c)$ is a regular submanifold of $M$ of codimension $k$. This follows directly from the above result and definition of regular submanifold.
	- **Immersion/submersion theorem**: since immersion/submersion has constant rank, as direct corollaries, an immersion can always be represented as $$(\psi\circ F\circ\phi^{-1})(r^1,\cdots,r^m)=(r_1,\cdots,r^m,0,\cdots,0),\quad m\le n$$while a submersion can always be represented as $$(\psi\circ F\circ\phi^{-1})(r^1,\cdots,r^m)=(r_1,\cdots,r^n),\quad m\ge n$$It's immediately obvious that a submersion is a open map. Notice that the regular level set theorem can be seen as a corollary of the submersion theorem.
- **Embedding**: $F\in C^\infty(M,N)$ is an embedding if it's an immersion, and $F(M)$ with the subspace topology inherited from $N$ is homeomorphic to $M$ under $F$ [[Topological Space]].
	- If $F$ is an embedding, then $F(N)$ is a regular submanifold. 
	  **Proof**: pick $(U,x^1,\cdots,x^m),(V,y^1,\cdots,y^n)$ containing $p,F(p)$. Since $F$ is homeomorphic $F(U)$ is open in $N$, hence by definition of subspace topology ([[Topological Space]]) there exists $V'$ s.t. $V'\cap F(N)=F(U)$. Now that $$V\cap V'\cap F(N)=V\cap F(U)=F(U)$$by the immersion theorem $F(U)$ has the adapted chart $(V\cap V',y^1,\cdots,y^n)$ and is defined by vanishing of $y^{m+1},\cdots,y_n$, hence $F(N)$ is a regular submanifold.
	- If $N\subset M$ is a regular submanifold, then the inclusion $\iota:N\to M$ is an embedding. This is because $\iota$ preserves the subspace topology, and is obviously an immersion.
- **Immersed submanifold**: the image of a bijective immersion $f$ ([[Differential Calculus on Smooth Manifold]]), together with the topology and differentiable structure inherited from $f$, is called the immersed submanifold. Notice that an immersed submanifold is generally not a submanifold.
## Other info
- **$C^\infty$ bump function**: obviously $f(t)=e^{-1/t}\chi_{(0,\infty)}$ is smooth on $\mathbb R$ and vanishes on $[-\infty,0]$. Let $$g(t)=\frac{f(t)}{f(t)+f(1-t)}\in C^\infty$$which is well defined and looks like a smooth step function. Further consider $$h(x)=g\left(\frac{x-a}{b-a}\right)\in C^\infty,\quad a<b\quad\Longrightarrow\quad h(x)=\begin{cases}0,&x\le a\\1,&x\ge b\end{cases}$$Finally let $\rho(x)=1-h(x^2)$, assuming $b>a>0$, then we get a bump function. For higher dimensions we only need to consider $\sigma(x)=\rho(\|x\|)$. This can easily be transferred to smooth manifold via coordinate system.
	- **$C^\infty$ extension of a function**: given $f\in C^\infty(U)$, although direct smooth extension of a given function do not generally exists (e.g. $\sec x$ on $(-\pi/2,\pi/2)$), it's possible if we only require them to agree on some neighborhood of a point $p\in U$. This can be done by taking a sufficiently small neighborhood and multiply $f$ with proper bump function $\rho(x)$.
- **Partition of unity**: a $C^\infty$ partition of unity is a collection $\set{\rho_\alpha\in C^\infty(M\to\mathbb R)}$ of non-negative functions s.t. $\supp\rho_\alpha$ is locally finite, and $\sum\rho_\alpha=1$. $\set{\rho_\alpha}$ is **subordinate** to the open cover $\set{U_\alpha}$ if $\supp\rho_\alpha\subset U_\alpha,\forall \alpha$.
	- **Locally finite sum**: by local finiteness the summation actually sum over only finitely many non-zero values at each point $p\in M$, hence is well-defined.
	- **Existence**: assuming compactness of $M$, for each $p\in M$ we pick a bump function $\psi_p$ centered at $p$ and a neighborhood $W_p$ s.t. $\psi_p>0,\forall x\in W_p$, and then pick a finite sub-cover of $\set{W_p}$, denoted $\set{W_i}$ with corresponding $p_i,\psi_i$. Now take $$\psi=\sum_i\psi_i,\quad\varphi_i=\frac{\psi_i}{\psi}$$Then $\varphi_i$ satisfies all the required properties. By re-indexing we can associate them with $\set{W_\alpha}$.
		- **General result**: given $\set{U_\alpha}$ a open cover of manifold $M$ there exists $C^\infty$ partition of unity $\set{\varphi_i}$ with $\supp\varphi_i$ compact, and $\supp\varphi_i\subset U_\alpha$ for some $\alpha=\alpha(i)$. If we do not require compact support then there exists a $C^\infty$ partition of unity $\set{\varphi_\alpha}$ subordinate to $\set{U_\alpha}$.
		- **Comparison with that in [[Topological Manifold]]**: for $X$ normal but not necessarily smooth we mainly uses the Urysohn lemma to construct a partition of unity. In smooth case general results relies on the smooth Urysohn lemma.